(this["webpackJsonp@webchat_test/admin-ui"]=this["webpackJsonp@webchat_test/admin-ui"]||[]).push([[0],[,,,,,,,,,,,,,function(e,n,t){},function(e,n,t){},,,function(e,n,t){},function(e,n,t){},function(e,n,t){},function(e,n,t){},function(e,n,t){},function(e,n,t){},function(e,n,t){},function(e,n,t){},function(e,n,t){"use strict";t.r(n);var c=t(1),o=t.n(c),s=t(7),i=t.n(s),r=(t(13),t(14),t(4)),a=t(2),u=o.a.createContext(void 0),d=window;d.reconnectionCount=0;var l=function e(n,t){try{var c=new WebSocket("wss://0cskis4880.execute-api.us-east-1.amazonaws.com/dev/");return c.onmessage=n,c.onopen=function(){!function(e){e.send(JSON.stringify({action:"sendmessage",data:{action:"config"}}))}(c),console.log("Requested configuration")},c.onclose=function(c){console.log("Socket closed by event:",c),console.log("Trying to reconnect..."),setTimeout((function(){if(d.reconnectionCount>=4)return console.error("Too many reconnection attempts"),void(t&&t("There are too many reconnection attempts. You are disconnected","error"));d.reconnectionCount++,console.log("!!!!!: ",d.reconnectionCount),clearTimeout(window.clearReconnectionCounterTimeOut);try{var c=e(n,t);window.clearReconnectionCounterTimeOut=setTimeout((function(){d.reconnectionCount=0}),1e4),console.log("Successfully reconnected: ",c)}catch(o){console.error("Error of reconnection: ",o),t&&t("You were disconnected from the chat","error")}}),1e3)},console.log("Successfully websocket connection:",c),c}catch(o){return console.log("Something went wrong while websocket connection: ",o),t&&t("You were disconnected from the chat","error"),null}},j=o.a.createContext(void 0),m=function(e,n){var t=Object(c.useState)(null),o=Object(a.a)(t,2),s=o[0],i=o[1],r=function(n){console.log("Got event:",n);var t=JSON.parse(n.data);t.type in e?e[t.type](t.data):console.error("Unhandled socket event type {".concat(t.type,"}:"),n)};return Object(c.useEffect)((function(){var e=l(r,n);i(e),n&&e&&n("Successful connection to the chat. You can chat")}),[]),s},b=t(8),f=t(0),g={format:"title",partsOfSpeech:["noun"],categories:{noun:["animals"]}},O=function(e){var n=e.children,t=Object(c.useState)([]),o=Object(a.a)(t,2),s=o[0],i=o[1],d=Object(c.useState)(null),l=Object(a.a)(d,2),O=l[0],h=l[1],v=Object(c.useState)([]),_=Object(a.a)(v,2),w=_[0],x=_[1],p=function(e){i((function(n){return[].concat(Object(r.a)(n),[e])}))},N=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info";p({type:n,msg:e,id:(new Date).getTime().toString()})},y=m({message:function(e){console.log("Received message:",e),i((function(n){return[].concat(Object(r.a)(n),[e])}))},config:function(e){console.log("Received config: ",e),h(e.userConnectionId),x((function(n){var t=n.filter((function(n){return e.connections.includes(n.connectionId)})),c=e.connections.filter((function(e){return!n.find((function(n){return n.connectionId===e}))})).map((function(e){return{connectionId:e,name:Object(b.generateSlug)(1,g)}}));return[].concat(Object(r.a)(t),Object(r.a)(c))}))}},N);return y?Object(f.jsx)(u.Provider,{value:{socket:y,connectionId:O,users:w},children:Object(f.jsx)(j.Provider,{value:{messages:s,log:N},children:n})}):Object(f.jsx)(f.Fragment,{children:"Loading..."})},h=(t(17),t.p+"static/media/bg.30eec6b5.mp4"),v=t.p+"static/media/bg.4f5e476d.png",_=function(e){return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)("img",{src:v,className:"static_bg"}),Object(f.jsx)("video",{className:"live_bg",src:h,autoPlay:!0,loop:!0,muted:!0,width:"100%",height:"100%"})]})},w=(t(18),t(19),function(e){var n=e.name,t=e.size;return Object(f.jsx)("div",{className:"user__avatar ".concat("micro"===t?"micro":""),children:Object(f.jsx)("span",{children:n[0].toUpperCase()})})}),x=function(e){var n=Object(c.useContext)(j).messages,t=Object(c.useContext)(u),o=t.connectionId,s=t.users,i=Object(c.useRef)(null);Object(c.useEffect)((function(){i.current&&(console.log(i.current.scrollHeight),i.current.scrollTop=i.current.scrollHeight)}),[n]);var r=n.map((function(e){if("type"in e)return Object(f.jsx)("li",{className:"message--system message--system--".concat(e.type),children:e.msg},e.id);var t=new Date(e.date),c=s.find((function(n){return n.connectionId===e.owner})),i=n.findIndex((function(n){return n.id===e.id})),r=!1;if(0!==i){var a=n[i-1];r="owner"in a&&a.owner===e.owner}return Object(f.jsxs)("li",{className:"message_wrapper ".concat(e.owner===o?"my":""," ").concat(r?"continues":""),children:[c&&Object(f.jsx)(w,{name:c.name,size:"micro"}),Object(f.jsxs)("div",{className:"message ".concat(e.owner===o?"my":""),children:[Object(f.jsxs)("span",{className:"message__time",children:[t.getHours(),":",t.getMinutes()]}),Object(f.jsx)("span",{className:"message__text",children:e.text})]},e.id)]})}));return Object(f.jsx)("div",{ref:i,className:"messages_list_wrapper",children:Object(f.jsx)("ul",{className:"messages_list",children:r})})},p=function(){var e=Object(c.useContext)(u).socket,n=Object(c.useContext)(j).log;return{sendMessage:function(t){try{!function(e,n){var t={action:"sendmessage",data:{action:"message",data:n.data}};e.send(JSON.stringify(t))}(e,{data:t})}catch(c){n("Something went wrong with sending","error")}}}},N=(t(20),function(e){var n=Object(c.useState)(""),t=Object(a.a)(n,2),o=t[0],s=t[1],i=p().sendMessage,r=function(){o.length<=0||(s(""),i(o))};return Object(f.jsxs)("div",{className:"message_editor_container",children:[Object(f.jsx)("textarea",{onKeyDown:function(e){"Enter"===e.code&&(r(),e.preventDefault())},value:o,onChange:function(e){s(e.target.value)},name:"msg_editor",id:"msg_editor_textarea",cols:5,rows:10}),Object(f.jsx)("button",{onClick:r,className:"message_editor__send_button"})]})}),y=(t(21),function(e){var n=e.className,t=e.children,c=e.sideBar,o=(e.containerClassName,e.controls),s=e.toolbar;return Object(f.jsxs)("div",{className:"window ".concat(n||""),children:[Object(f.jsx)("div",{className:"window__header",children:Object(f.jsxs)("div",{className:"window_header__container",children:[o&&Object(f.jsx)("div",{className:"window__controls"}),s||null]})}),Object(f.jsxs)("div",{className:"window__inner",children:[c&&Object(f.jsx)("div",{className:"window__sidebar",children:c}),Object(f.jsx)("div",{className:"window__content",children:t})]})]})}),C=(t(22),t(23),t(24),function(e){var n=e.size,t=Object(c.useContext)(u),o=t.users,s=t.connectionId;return Object(f.jsx)("ul",{className:"main_sidebar__user_list ".concat(n),children:o.map((function(e){return Object(f.jsxs)("li",{className:"user_list__user ".concat(e.connectionId==s?"my":""),children:[Object(f.jsx)(w,{size:n,name:e.name}),!("min"===n||"micro"===n)&&Object(f.jsx)("span",{className:"user__name",children:e.name})]},e.connectionId)}))})}),S=function(e){var n=Object(c.useState)(window.innerWidth),t=Object(a.a)(n,2),o=t[0],s=t[1];Object(c.useEffect)((function(){var e=function(e){s(e.currentTarget.innerWidth)};return window.addEventListener("resize",e),function(){return window.removeEventListener("resize",e)}}),[]);var i=o<500?"micro":o<600?"min":"std";return Object(f.jsx)("div",{className:"main_sidebar ".concat(i),children:Object(f.jsxs)("div",{className:"main_sidebar__inner main_sidebar__container",children:[Object(f.jsx)("h3",{className:"main_sidebar__title",children:"Users"}),Object(f.jsx)(C,{size:i})]})})},I=function(e){return Object(f.jsx)(y,{className:"main_window",controls:!0,sideBar:Object(f.jsx)(S,{}),children:Object(f.jsxs)("div",{className:"main_window__container",children:[Object(f.jsx)(x,{}),Object(f.jsx)(N,{})]})})};var T=function(){return Object(f.jsx)(O,{children:Object(f.jsxs)("div",{className:"App",children:[Object(f.jsx)(_,{}),Object(f.jsx)("div",{className:"app__container",children:Object(f.jsx)(I,{})})]})})},k=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,26)).then((function(n){var t=n.getCLS,c=n.getFID,o=n.getFCP,s=n.getLCP,i=n.getTTFB;t(e),c(e),o(e),s(e),i(e)}))};i.a.render(Object(f.jsx)(o.a.StrictMode,{children:Object(f.jsx)(T,{})}),document.getElementById("root")),k()}],[[25,1,2]]]);
//# sourceMappingURL=main.c890e9eb.chunk.js.map