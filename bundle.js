!function(i){var n={};function s(e){if(n[e])return n[e].exports;var t=n[e]={i:e,l:!1,exports:{}};return i[e].call(t.exports,t,t.exports,s),t.l=!0,t.exports}s.m=i,s.c=n,s.d=function(e,t,i){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)s.d(i,n,function(e){return t[e]}.bind(null,n));return i},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=44)}([function(e){e.exports=JSON.parse('{"global":{"pause":"Escape"},"player1":{"up":"ArrowUp","right":"ArrowRight","down":"ArrowDown","left":"ArrowLeft","stop":"Space"},"player2":{"up":"KeyW","right":"KeyD","down":"KeyS","left":"KeyA","stop":"ControlLeft"}}')},function(e,t,i){e.exports=i.p+"images/stone_isolated530604dccd1027bb334d370e760672af.png"},function(e,t,i){e.exports=i.p+"images/stone_connectedLeft03e139b568e980c526f258a3fdbe2db3.png"},function(e,t,i){e.exports=i.p+"images/stone_connectedRight9630d0eca64a83f89c85a677b7ed0591.png"},function(e,t,i){e.exports=i.p+"images/stone_connectedTop425f2bf74a3c530d5145f009797caeef.png"},function(e,t,i){e.exports=i.p+"images/stone_connectedBottome35dac4c9000db1c2bf2b433503548ac.png"},function(e,t,i){e.exports=i.p+"images/stone_betweenHorizontal1bcac0e006e6ca70e9cdb1de5d239275.png"},function(e,t,i){e.exports=i.p+"images/stone_betweenVertical0fa8ed46940ffb0b40e92112c3bb5117.png"},function(e,t,i){e.exports=i.p+"images/stone_connectedBottomAndRight8853bd17731c3da6469566ae81ac86eb.png"},function(e,t,i){e.exports=i.p+"images/stone_connectedBottomAndLeft2d0d1517c16a635f1cf88794aea50b78.png"},function(e,t,i){e.exports=i.p+"images/stone_connectedTopAndLefte4f30c376a7d801637aef9b31e930b61.png"},function(e,t,i){e.exports=i.p+"images/stone_connectedTopAndRight0a8ce7f24cb6bb02ecc7760ff51b53d8.png"},function(e,t,i){e.exports=i.p+"images/stone_connectedAllcea47e078b48229b4f5521d0aefc3fa1.png"},function(e,t,i){e.exports=i.p+"images/stone_betweenVertical_connectedLeftb70cfaea10c2845ab31e8b7a0ea7d81e.png"},function(e,t,i){e.exports=i.p+"images/stone_betweenVertical_connectedRight1a92a44c4aa5ed6fedf011e2d48550b3.png"},function(e,t,i){e.exports=i.p+"images/stone_betweenHorizontal_connectedTopb680910a072ca770c146a7da80b5f968.png"},function(e,t,i){e.exports=i.p+"images/stone_betweenHorizontal_connectedBottom0096561effda01952033463a7c317b8c.png"},function(e,t,i){e.exports=i.p+"images/cell4bda028508a52dd3adf210d58377467d.png"},function(e,t,i){e.exports=i.p+"images/player1_anim1_right9bfd7ee41213f2b0d23c74bc007407e0.png"},function(e,t,i){e.exports=i.p+"images/player1_anim2_right93e98b2990c304402f842e201d1bb7bf.png"},function(e,t,i){e.exports=i.p+"images/player1_anim3_right9eca4886517844d4c1a305e07a6f1115.png"},function(e,t,i){e.exports=i.p+"images/player1_anim4_rightfb5bd7c62007dec510cca01da7a899b2.png"},function(e,t,i){e.exports=i.p+"images/player1_anim5_rightf7838ce0a537ad5af948f0456dcbc121.png"},function(e,t,i){e.exports=i.p+"images/player1_anim6_rightec1634d5b0f7c26fae439e1aed6e415b.png"},function(e,t,i){e.exports=i.p+"images/player1_anim1_left74c51faf5445f93500a60b19df0e5a60.png"},function(e,t,i){e.exports=i.p+"images/player1_anim2_leftee23cf4539e17c1d6f1c61faf26ff28f.png"},function(e,t,i){e.exports=i.p+"images/player1_anim3_lefta4c029cb1b495f9e5e7b283ade93f035.png"},function(e,t,i){e.exports=i.p+"images/player1_anim4_left78912436b9af436f1f0a39aa452c5f92.png"},function(e,t,i){e.exports=i.p+"images/player1_anim5_left4b614f7b9a920a93a425f140849dc866.png"},function(e,t,i){e.exports=i.p+"images/player1_anim6_left487edb28d9709968bf913ea3ace284a6.png"},function(e,t,i){e.exports=i.p+"images/player1_stop_left047f294e8721689677ee3d9ba0e09c36.png"},function(e,t,i){e.exports=i.p+"images/player1_stop_right3a87b216056a94be56b079b064e807f5.png"},function(e,t,i){e.exports=i.p+"images/coin1174086130a29db6bd8b68eb8d4ea3944.png"},function(e,t,i){e.exports=i.p+"images/coin21014ba4e51873018ada0e0e85694068e.png"},function(e,t,i){e.exports=i.p+"images/coin3777c81244a45759066080a7ebc97ddc0.png"},function(e,t,i){e.exports=i.p+"images/coin41022d70d9b4eea50c95a7d52baddfe70.png"},function(e,t,i){e.exports=i.p+"images/coin5aa0cd54f2f444f6d5e26cbd797d5085e.png"},function(e,t,i){e.exports=i.p+"images/coin6d2318616b4617445adf4057d29149b13.png"},function(e,t,i){e.exports=i.p+"images/trap136f832c521207ef3736e296742c1406e.png"},function(e,t,i){e.exports=i.p+"images/trap262e702b493194bc9124e141c15fa01c9.png"},function(e,t,i){e.exports=i.p+"images/trap30b734cdd970ea5ee118791a1f9c6354a.png"},function(e,t,i){e.exports=i.p+"images/trap4efecbf66c8494d6f0d7b14957bd8e47f.png"},function(e,t,i){e.exports=i.p+"sounds/coin276507ac96a9c75bc2ab6f40f74a19547.mp3"},function(e,t,i){},function(e,t,i){"use strict";i.r(t);i(43);var n=i(1),s=i.n(n),a=i(2),o=i.n(a),r=i(3),c=i.n(r),p=i(4),h=i.n(p),l=i(5),f=i.n(l),d=i(6),u=i.n(d),m=i(7),g=i.n(m),b=i(8),v=i.n(b),w=i(9),y=i.n(w),S=i(10),C=i.n(S),k=i(11),_=i.n(k),I=i(12),L=i.n(I),j=i(13),x=i.n(j),O=i(14),Y=i.n(O),A=i(15),E=i.n(A),X=i(16),P=i.n(X),G=i(17),z=i.n(G),R=i(18),T=i.n(R),H=i(19),B=i.n(H),F=i(20),M=i.n(F),D=i(21),W=i.n(D),V=i(22),$=i.n(V),q=i(23),K=i.n(q),N=i(24),U=i.n(N),J=i(25),Q=i.n(J),Z=i(26),ee=i.n(Z),te=i(27),ie=i.n(te),ne=i(28),se=i.n(ne),ae=i(29),oe=i.n(ae),re=i(30),ce=i.n(re),pe=i(31),he=i.n(pe),le=i(32),fe=i.n(le),de=i(33),ue=i.n(de),me=i(34),ge=i.n(me),be=i(35),ve=i.n(be),we=i(36),ye=i.n(we),Se=i(37),Ce=i.n(Se),ke=i(38),_e=i.n(ke),Ie=i(39),Le=i.n(Ie),je=i(40),xe=i.n(je),Oe=i(41),Ye=i.n(Oe),Ae=i(42),Ee=i.n(Ae);function Xe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Pe(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ge(e,t,i){return t&&Pe(e.prototype,t),i&&Pe(e,i),e}var ze=new Image;ze.src=s.a;var Re=new Image;Re.src=o.a;var Te=new Image;Te.src=c.a;var He=new Image;He.src=h.a;var Be=new Image;Be.src=f.a;var Fe=new Image;Fe.src=u.a;var Me=new Image;Me.src=g.a;var De=new Image;De.src=v.a;var We=new Image;We.src=y.a;var Ve=new Image;Ve.src=C.a;var $e=new Image;$e.src=_.a;var qe=new Image;qe.src=L.a;var Ke=new Image;Ke.src=x.a;var Ne=new Image;Ne.src=Y.a;var Ue=new Image;Ue.src=E.a;var Je=new Image;Je.src=P.a;var Qe=new Image;Qe.src=z.a;var Ze=new Image;Ze.src=T.a;var et=new Image;et.src=B.a;var tt=new Image;tt.src=M.a;var it=new Image;it.src=W.a;var nt=new Image;nt.src=$.a;var st=new Image;st.src=K.a;var at=new Image;at.src=U.a;var ot=new Image;ot.src=Q.a;var rt=new Image;rt.src=ee.a;var ct=new Image;ct.src=ie.a;var pt=new Image;pt.src=se.a;var ht=new Image;ht.src=oe.a;var lt=new Image;lt.src=ce.a;var ft=new Image;ft.src=he.a;var dt=new Image;dt.src=fe.a;var ut=new Image;ut.src=ue.a;var mt=new Image;mt.src=ge.a;var gt=new Image;gt.src=ve.a;var bt=new Image;bt.src=ye.a;var vt=new Image;vt.src=Ce.a;var wt=new Image;wt.src=_e.a;var yt=new Image;yt.src=Le.a;var St=new Image;St.src=xe.a;var Ct=new Image;function kt(e,t,i,n,s,a){var o={type:t,id:t+e,visible:!0,material:n,posX:s,posY:a,eventList:[],sprite:null,spriteList:[],animateSpriteCount:0,animateSpeedCount:0,animateSpeed:1,spriteWidth:0,spriteHeight:0,spriteOffsetX:0,spriteOffsetY:0};return o.die=function(){window.Game.removeObject(this)}.bind(o),o.staticAnimate=function(){this.animateSpeedCount===this.animateSpeed?(this.animateSpeedCount=0,this.animateSpriteCount===this.spriteList.length-1?this.animateSpriteCount=0:this.animateSpriteCount+=1,this.sprite=this.spriteList.getSprite(this.animateSpriteCount,this.direction)):this.animateSpeedCount+=1}.bind(o),o.moveAnimate=function(){if(!this.moves)return this.animateSpriteCount=0,this.animateSpeedCount=0,void(this.sprite=this.spriteList.getStopSprite(this.direction));this.animateSpeedCount===this.animateSpeed?(this.animateSpeedCount=0,this.animateSpriteCount===this.spriteList.length-1?this.animateSpriteCount=0:this.animateSpriteCount+=1,this.sprite=this.spriteList.getSprite(this.animateSpriteCount,this.direction)):this.animateSpeedCount+=1}.bind(o),i instanceof At?i.default?(o.spriteList=i,o.sprite=i.default[0],o.eventList.push(new Yt("staticAnimate",o.staticAnimate,!1))):(o.spriteList=i,o.sprite=i.right[0],o.eventList.push(new Yt("moveAnimate",o.moveAnimate,!1))):i.length?(o.spriteList=i,o.sprite=i[0]):o.sprite=i,o.addEvent=function(t,e,i,n){n&&(this.eventList=this.eventList.filter(function(e){return e.id!=="event"+t})),this.eventList.push(new Yt(t||this.eventList.length,e,i))}.bind(o),o.addEventToStart=function(t,e,i,n){n&&(this.eventList=this.eventList.filter(function(e){return e.id!=="event"+t})),this.eventList.unshift(new Yt(t||this.eventList.length,e,i))}.bind(o),o.startEvents=function(){var t=[];0<this.eventList.length&&(this.eventList.forEach(function(e){e.func(),e.removable||t.push(e)}),this.eventList=t)}.bind(o),o.checkClash=function(e,t){if(e.id!==this.id){var i,n,s=t/2,a=this.posX-s,o=this.posX+s,r=this.posY-s,c=this.posY+s,p=e.posX-s,h=e.posX+s,l=e.posY-s,f=e.posY+s;if(l<c&&r<f&&a<h&&p<o)if(this.clash(e),e.clash(this),"stone"===this.type)switch(i=this.posX<e.posX?"right":this.posX>e.posX?"left":"one level",n=this.posY<e.posY?"bottom":this.posY>e.posY?"top":"one level",Math.abs(this.posX-e.posX)>Math.abs(this.posY-e.posY)?i:n){case"right":"left"===e.direction&&(e.addEventToStart("stop",e.stopMove,!0),e.posX+=e.speed);break;case"left":"right"===e.direction&&(e.addEventToStart("stop",e.stopMove,!0),e.posX-=e.speed);break;case"bottom":"top"===e.direction&&(e.addEventToStart("stop",e.stopMove,!0),e.posY+=e.speed);break;case"top":"bottom"===e.direction&&(e.addEventToStart("stop",e.stopMove,!0),e.posY-=e.speed)}}}.bind(o),o.clash=function(e){}.bind(o),o}function _t(e,t,i,n,s,a,o){var r=new kt(e,t,i,!0,n,s);return r.hp=a||100,r.direction="top",r.moves=!1,r.speed=o||1,r.changeDirection=function(t){("left"!==this.direction&&"right"!==this.direction||"left"!==t&&"right"!==t)&&("top"!==this.direction&&"bottom"!==this.direction||"top"!==t&&"bottom"!==t)?this.addEventToStart("tryChangeDirection",function(){var e=window.Game.findCell({object:{posX:r.posX,posY:r.posY},direction:t});r.posX/20%2==1&&r.posY/20%2==1&&e&&0<e.objects.length&&"stone"!==e.objects[0].type&&(r.direction=t,this.removable=!0)},!1,!0):this.direction=t}.bind(r),r.startMove=function(){this.moves=!0}.bind(r),r.stopMove=function(){this.moves=!1}.bind(r),r.move=function(){if(this.moves)switch(this.direction){case"left":this.posX-=this.speed;break;case"right":this.posX+=this.speed;break;case"top":this.posY-=this.speed;break;case"bottom":this.posY+=this.speed}}.bind(r),r}function It(e,t,i,n,s){var a=new _t(e,"player",new At({left:[at,ot,rt,ct,pt,ht],right:[Ze,et,tt,it,nt,st],stop:{left:lt,right:ft}}),t,i,100,4);return a.nickName=n||"Unamed",a.score=s||0,a.eventList.push(new Yt("move",a.move,!1)),a.spriteWidth=49,a.spriteHeight=53,a.spriteOffsetX=0,a.spriteOffsetY=-6,a.upScore=function(e){this.score+=e}.bind(a),a.clash=function(e){"coin"===e.type&&this.upScore(1)}.bind(a),a.control=function(e){switch(e){case"up":this.changeDirection("top"),this.startMove();break;case"right":this.changeDirection("right"),this.startMove();break;case"down":this.changeDirection("bottom"),this.startMove();break;case"left":this.changeDirection("left"),this.startMove();break;case"stop":this.stopMove()}}.bind(a),a}function Lt(e,t,i){var n=new kt(e,"stone",ze,!0,t,i);return n.spriteWidth=40,n.spriteHeight=52,n.spriteOffsetY=-6,n.stoneSprites={isolated:ze,connectedLeft:Re,connectedRight:Te,connectedTop:He,connectedBottom:Be,betweenHorizontal:Fe,betweenVertical:Me,connectedBottomAndRight:De,connectedBottomAndLeft:We,connectedTopAndLeft:Ve,connectedTopAndRight:$e,connectedAll:qe,betweenVerticalConnectedRight:Ne,betweenVerticalConnectedLeft:Ke,betweenHorizontalConnectedBottom:Je,betweenHorizontalConnectedTop:Ue},n.setSprite=function(e){this.stoneSprites[e]&&(this.sprite=this.stoneSprites[e])}.bind(n),n}function jt(e,t,i){var n=new kt(e,"coin",new At([dt,ut,mt,gt,bt,vt]),!0,t,i);return n.spriteWidth=25,n.spriteHeight=28,n.spriteOffsetY=-15,n.animateSpeed=2,n.clash=function(e){if("player"===e.type){var t=new Audio;t.src=Ee.a,t.volume=.005,t.play(),this.die()}}.bind(n),n}function xt(e,t,i,n){var s=new kt(e,"trap",new At([wt,yt,St,Ct,St,yt]),!0,t,i);return s.active=!1,s.animateSpeed=1,s.staticAnimate=function(){s.active=3===this.animateSpriteCount||2===this.animateSpriteCount,0===this.animateSpriteCount||3===this.animateSpriteCount?this.animateSpeedCount===this.animateSpeed*n?(this.animateSpriteCount+=1,this.animateSpeedCount=0):this.animateSpeedCount+=1:this.animateSpeedCount===this.animateSpeed?(this.animateSpeedCount=0,this.animateSpriteCount===this.spriteList.length-1?this.animateSpriteCount=0:this.animateSpriteCount+=1,this.sprite=this.spriteList.getSprite(this.animateSpriteCount,this.direction)):this.animateSpeedCount+=1}.bind(s),s.addEvent("staticAnimate",s.staticAnimate,!1,!0),s.clash=function(e){this.active&&"player"===e.type&&e.die()}.bind(s),s}Ct.src=Ye.a;var Ot=function(){function a(e,t,i,n,s){Xe(this,a),this.id="cell"+e,this.posX=t,this.posY=i,this.objects=[],this.sprite=Qe,this.visible=!0,this.fieldPosRow=n,this.fieldPosColumn=s}return Ge(a,[{key:"set",value:function(e){this.objects.push(e),e.posX=this.posX,e.posY=this.posY}},{key:"clear",value:function(e){e&&this.objects.forEach(function(e){e.die()}),this.objects=[]}}]),a}(),Yt=function e(t,i,n){Xe(this,e),this.id="event"+t,this.func=i,this.removable=void 0===n||n},At=function(){function t(e){Xe(this,t),e.length?(this.default=e,this.length=e.length):(this.right=e.right,this.left=e.left,e.stop&&(this.stop={right:e.stop.right,left:e.stop.left}),this.length=e.left.length),this.lastDirection="right"}return Ge(t,[{key:"getStopSprite",value:function(e){return"right"===e?(this.lastDirection=e,this.stop.right):"left"===e?(this.lastDirection=e,this.stop.left):this.getStopSprite(this.lastDirection)}},{key:"getSprite",value:function(e,t){return t?"right"===t?(this.lastDirection=t,this.right[e]):"left"===t?(this.lastDirection=t,this.left[e]):this.getSprite(e,this.lastDirection):this.default[e]}}]),t}(),Et=[new function e(t,i,n,s,a){Xe(this,e),this.stoneList=t,this.traps=i,this.playersFieldCoords=n,this.mobSpawnPoints=s,this.holesInBaseStones=a}([[1,5],[1,8],[1,9],[1,11],[1,13],[1,14],[1,17],[2,2],[2,3],[2,5],[2,7],[2,8],[2,11],[2,14],[2,15],[2,17],[2,19],[2,20],[3,2],[3,7],[3,8],[3,10],[3,11],[3,12],[3,14],[3,15],[3,20],[4,4],[4,5],[4,17],[4,18],[5,1],[5,7],[5,8],[5,9],[5,11],[5,13],[5,14],[5,15],[5,21],[6,3],[6,5],[6,9],[6,11],[6,13],[6,17],[6,19],[7,1],[7,2],[7,3],[7,5],[7,6],[7,11],[7,16],[7,17],[7,19],[7,20],[7,21],[8,8],[8,9],[8,10],[8,11],[8,12],[8,13],[8,14],[9,1],[9,2],[9,3],[9,5],[9,6],[9,16],[9,17],[9,19],[9,20],[9,21],[10,3],[10,5],[10,8],[10,10],[10,12],[10,14],[10,17],[10,19],[11,7],[11,8],[11,10],[11,12],[11,14],[11,15],[12,2],[12,4],[12,5],[12,17],[12,18],[12,20],[13,2],[13,4],[13,5],[13,7],[13,8],[13,10],[13,11],[13,12],[13,14],[13,15],[13,17],[13,18],[13,20],[14,2],[14,4],[14,5],[14,7],[14,10],[14,11],[14,12],[14,15],[14,17],[14,18],[14,20],[15,7],[15,9],[15,10],[15,11],[15,12],[15,13],[15,15]],[[3,5],[3,17],[4,11],[8,5],[8,6],[8,16],[8,17],[10,11],[11,11],[13,3],[13,19]],[[1,1],[1,21]],[],[[8,0],[8,22]])],Xt=i(0);function Pt(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Gt(e){return function(e){if(Array.isArray(e)){for(var t=0,i=new Array(e.length);t<e.length;t++)i[t]=e[t];return i}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function zt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Rt(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Tt(e,t,i){return t&&Rt(e.prototype,t),i&&Rt(e,i),e}var Ht=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$gameWindow=document.querySelector(".canvasWrapper"),this.$interface=document.querySelector(".interface"),this.$playerInfoBlocks=[]}return function(e,t,i){t&&Pt(e.prototype,t),i&&Pt(e,i)}(e,[{key:"gamePause",value:function(){this.$gameWindow.classList.toggle("pause")}},{key:"touchHandler",value:function(){}},{key:"setControls",value:function(t){document.addEventListener("keydown",function(e){return t(e)})}},{key:"createInterface",value:function(e){var a=this;e.players.forEach(function(e,t){var i=document.createElement("div"),n=document.createElement("span"),s=new Image;i.className="player_info player_info--".concat(e.id),n.className="player_info__score",n.innerHTML="Score: <span class='score_value'>".concat(e.score,"</span>"),s.src=e.sprite.src,i.append(s),i.append(n),a.$interface.append(i),a.$playerInfoBlocks.push(i)})}},{key:"interfaceReload",value:function(e){var i=this;e.players.forEach(function(t){i.$playerInfoBlocks.find(function(e){return e.classList.contains("player_info--".concat(t.id))}).querySelector(".score_value").textContent=t.score})}}]),e}()),Bt=function(){function e(){zt(this,e),this.canvas=document.querySelector("#canvas"),this.ctx=this.canvas.getContext("2d"),this.windowWidth=this.canvas.clientWidth,this.windowHeight=this.canvas.clientHeight,this.cellSize=40,this.drawBackground()}return Tt(e,[{key:"drawObject",value:function(e){if(e.visible){var t=e.spriteWidth,i=e.spriteHeight,n=e.posX-this.cellSize/2,s=e.posY-this.cellSize/2;t&&i&&(n=e.posX-t/2,s=e.posY-i/2),e.spriteOffsetX&&(n+=e.spriteOffsetX),e.spriteOffsetY&&(s+=e.spriteOffsetY);try{this.ctx.drawImage(e.sprite,n,s,t||this.cellSize,i||this.cellSize)}catch(e){}}}},{key:"drawCell",value:function(e){e.object&&e.object.visible&&this.drawObject(e.object)}},{key:"drawBackground",value:function(){this.ctx.fillStyle="black",this.ctx.fillRect(0,0,this.windowWidth,this.windowHeight)}}]),e}();(new(function(){function t(e){zt(this,t),(window.Game=this).eventList=[],this.Graphic=new Bt,this.gameInterval=null,this.gameField=[],this.gameSpeed=30,this.paused=!1,this.stones=[],this.players=[],this.mobs=[],this.loot=[],this.traps=[],this.trapDuration=40,this.mapList=Et,this.allObjects=[].concat(Gt(this.stones),Gt(this.players),Gt(this.mobs)),this.mapCreate(this.mapList[0]),this.setControls(),Ht.createInterface({players:this.players})}return Tt(t,[{key:"addObject",value:function(e,t){switch(t){case"stone":this.stones.push(e);break;case"player":this.players.push(e);break;case"mobs":this.mobs.push(e);break;case"loot":this.loot.push(e);break;case"trap":this.traps.push(e)}this.allObjects.push(e)}},{key:"removeObject",value:function(t){switch(this.allObjects=this.allObjects.filter(function(e){return e.id!==t.id}),t.type){case"stone":this.stones=this.stones.filter(function(e){return e.id!==t.id}),this.stonePositionAnalyse();break;case"player":this.players=this.players.filter(function(e){return e.id!==t.id});break;case"mob":this.mobs=this.mobs.filter(function(e){return e.id!==t.id});break;case"loot":this.loot=this.loot.filter(function(e){return e.id!==t.id});break;case"trap":this.traps=this.traps.filter(function(e){return e.id!==t.id});break;default:this.loot=this.loot.filter(function(e){return e.id!==t.id})}}},{key:"setControls",value:function(){var s=this;Ht.setControls(function(e){var t=Xt.player1,i=Xt.player2,n=Xt.global;if(!s.paused)switch(e.code){case t.up:s.players[0].control("up");break;case t.right:s.players[0].control("right");break;case t.down:s.players[0].control("down");break;case t.left:s.players[0].control("left");break;case t.stop:s.players[0].control("stop");break;case i.up:s.players[1].control("up");break;case i.right:s.players[1].control("right");break;case i.down:s.players[1].control("down");break;case i.left:s.players[1].control("left");break;case i.stop:s.players[1].control("stop")}e.code===n.pause&&(s.paused?(s.start(),s.paused=!1):(s.pause(),s.paused=!0),Ht.gamePause())})}},{key:"findCell",value:function(t){var i,n,e,s=[];this.gameField.forEach(function(e){e.forEach(function(e){return s.push(e)})});var a=this.Graphic.cellSize/2;if(t.fieldPosRow&&t.fieldPosColumn)e=s.find(function(e){return e.fieldPosRow===t.fieldPosRow&&e.fieldPosColumn===t.fieldPosColumn});else if(t.posX&&t.posY)i=t.posX,n=t.posY,e=s.find(function(e){return e.posX-a<=i&&e.posX+a>=i&&e.posY-a<=n&&e.posY+a>=n});else if(t.object&&t.direction){i=t.object.posX,n=t.object.posY;var o=s.find(function(e){return e.posX-a<=i&&e.posX+a>=i&&e.posY-a<=n&&e.posY+a>=n});if(!o)return null;switch(t.direction){case"top":e=this.findCell({fieldPosRow:o.fieldPosRow-1,fieldPosColumn:o.fieldPosColumn});break;case"right":e=this.findCell({fieldPosRow:o.fieldPosRow,fieldPosColumn:o.fieldPosColumn+1});break;case"bottom":e=this.findCell({fieldPosRow:o.fieldPosRow+1,fieldPosColumn:o.fieldPosColumn});break;case"left":e=this.findCell({fieldPosRow:o.fieldPosRow,fieldPosColumn:o.fieldPosColumn-1})}}return e}},{key:"stonePositionAnalyse",value:function(){var s=function(e,t){return this.gameField[e]&&this.gameField[e][t]&&0<this.gameField[e][t].objects.length&&"stone"===this.gameField[e][t].objects[0].type}.bind(this);this.gameField.forEach(function(e,n){e.forEach(function(e,t){if(0<e.objects.length&&"stone"===e.objects[0].type){var i=e.objects[0];s(n-1,t)&&s(n+1,t)&&s(n,t-1)&&s(n,t+1)?i.setSprite("connectedAll"):s(n-1,t)&&s(n+1,t)&&s(n,t+1)?i.setSprite("betweenVerticalConnectedRight"):s(n-1,t)&&s(n+1,t)&&s(n,t-1)?i.setSprite("betweenVerticalConnectedLeft"):s(n,t-1)&&s(n,t+1)&&s(n+1,t)?i.setSprite("betweenHorizontalConnectedBottom"):s(n,t-1)&&s(n,t+1)&&s(n-1,t)?i.setSprite("betweenHorizontalConnectedTop"):s(n+1,t)&&s(n,t+1)?i.setSprite("connectedBottomAndRight"):s(n+1,t)&&s(n,t-1)?i.setSprite("connectedBottomAndLeft"):s(n-1,t)&&s(n,t+1)?i.setSprite("connectedTopAndRight"):s(n-1,t)&&s(n,t-1)?i.setSprite("connectedTopAndLeft"):s(n,t+1)&&s(n,t-1)?i.setSprite("betweenHorizontal"):s(n+1,t)&&s(n-1,t)?i.setSprite("betweenVertical"):s(n-1,t)?i.setSprite("connectedTop"):s(n,t-1)?i.setSprite("connectedLeft"):s(n+1,t)?i.setSprite("connectedBottom"):s(n,t+1)&&i.setSprite("connectedRight")}})})}},{key:"addStone",value:function(e,t,i){var n;n=i||new Lt("".concat(e,"_").concat(t)),this.addObject(n,"stone"),this.gameField[e][t].set(n)}},{key:"addStones",value:function(e){var s=this;e.forEach(function(e){var t=e[0],i=e[1],n=new Lt("".concat(t,"_").concat(i));s.addObject(n,"stone"),s.gameField[t][i].set(n)})}},{key:"mapCreate",value:function(e){for(var s=this,t=0;t<this.Graphic.windowHeight/this.Graphic.cellSize;t++){this.gameField[t]=[];for(var i=0;i<this.Graphic.windowWidth/this.Graphic.cellSize;i++)if(this.gameField[t][i]=new Ot("".concat(t,"_").concat(i),i*this.Graphic.cellSize+this.Graphic.cellSize/2,t*this.Graphic.cellSize+this.Graphic.cellSize/2,t,i),0===t||t===this.Graphic.windowHeight/this.Graphic.cellSize-1||0===i||i===this.Graphic.windowWidth/this.Graphic.cellSize-1){var n=new Lt("".concat(t,"_").concat(i));0===t||t===this.Graphic.windowHeight/this.Graphic.cellSize-1?0<i&&i<this.Graphic.windowWidth/this.Graphic.cellSize-1?n.setSprite("betweenHorizontal"):0===i?0===t?n.setSprite("connectedBottomAndRight"):n.setSprite("connectedTopAndRight"):0===t?n.setSprite("connectedBottomAndLeft"):n.setSprite("connectedTopAndLeft"):n.setSprite("betweenVertical"),this.addObject(n,"stone"),this.gameField[t][i].set(n)}}this.addStones(e.stoneList),e.holesInBaseStones.forEach(function(e){s.gameField[e[0]][e[1]].clear(!0)}),e.traps.forEach(function(e){var t=new xt("".concat(e[0],"_").concat(e[1]),null,null,s.trapDuration);s.addObject(t,"trap"),s.gameField[e[0]][e[1]].set(t)}),e.playersFieldCoords.forEach(function(e,t){s.players[t]||(s.addObject(new It(t),"player"),s.gameField[e[0]][e[1]].set(s.players[t]))}),this.stonePositionAnalyse(),this.gameField.forEach(function(e,n){e.forEach(function(e,t){if(0===e.objects.length){var i=new jt("".concat(n,"_").concat(t),e.posX,e.posY);s.addObject(i,"loot"),e.set(i)}})})}},{key:"drawFrame",value:function(){var t=this;this.gameField.forEach(function(e){return e.forEach(function(e){t.Graphic.drawObject(e)})}),this.allObjects=this.allObjects.sort(function(e,t){return e.posY-t.posY}),this.traps.forEach(function(e){return t.Graphic.drawObject(e)}),this.allObjects.forEach(function(e){"trap"!==e.type&&t.Graphic.drawObject(e)})}},{key:"checkOverflow",value:function(){var t=this;[].concat(Gt(this.mobs),Gt(this.players)).forEach(function(e){e.posX>t.Graphic.windowWidth+t.Graphic.cellSize?e.posX=0-t.Graphic.cellSize:e.posX<0-t.Graphic.cellSize?e.posX=t.Graphic.windowWidth+t.Graphic.cellSize:e.posY>t.Graphic.windowHeight+t.Graphic.cellSize?e.posY=0-t.Graphic.cellSize:e.posY<0-t.Graphic.cellSize&&(e.posY=t.Graphic.windowHeight+t.Graphic.cellSize)})}},{key:"checkClash",value:function(){var i=this,e=[].concat(Gt(this.mobs),Gt(this.players));this.allObjects.forEach(function(t){e.forEach(function(e){t.material&&e.material&&t.checkClash(e,i.Graphic.cellSize)})})}},{key:"gameLoop",value:function(){}},{key:"start",value:function(){var e=this;this.gameInterval=setInterval(function(){e.checkClash(),e.eventList.forEach(function(e){return e()}),e.eventList=[],e.allObjects.forEach(function(e){e.eventList&&0<e.eventList.length&&e.startEvents()}),e.checkOverflow(),e.drawFrame(),Ht.interfaceReload({players:e.players})},1/this.gameSpeed*1e3)}},{key:"pause",value:function(){clearInterval(this.gameInterval)}}]),t}())).start()}]);