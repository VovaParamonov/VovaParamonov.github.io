!function(i){var n={};function a(e){if(n[e])return n[e].exports;var t=n[e]={i:e,l:!1,exports:{}};return i[e].call(t.exports,t,t.exports,a),t.l=!0,t.exports}a.m=i,a.c=n,a.d=function(e,t,i){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(a.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)a.d(i,n,function(e){return t[e]}.bind(null,n));return i},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=45)}([function(e){e.exports=JSON.parse('{"global":{"pause":"Escape"},"player1":{"up":"ArrowUp","right":"ArrowRight","down":"ArrowDown","left":"ArrowLeft","stop":"Space"},"player2":{"up":"KeyW","right":"KeyD","down":"KeyS","left":"KeyA","stop":"ControlLeft"}}')},function(e,t,i){e.exports=i.p+"images/heartf8c80154c2b405d07e94a26a2c753358.png"},function(e,t,i){e.exports=i.p+"images/stone_isolated530604dccd1027bb334d370e760672af.png"},function(e,t,i){e.exports=i.p+"images/stone_connectedLeft03e139b568e980c526f258a3fdbe2db3.png"},function(e,t,i){e.exports=i.p+"images/stone_connectedRight9630d0eca64a83f89c85a677b7ed0591.png"},function(e,t,i){e.exports=i.p+"images/stone_connectedTop425f2bf74a3c530d5145f009797caeef.png"},function(e,t,i){e.exports=i.p+"images/stone_connectedBottome35dac4c9000db1c2bf2b433503548ac.png"},function(e,t,i){e.exports=i.p+"images/stone_betweenHorizontal1bcac0e006e6ca70e9cdb1de5d239275.png"},function(e,t,i){e.exports=i.p+"images/stone_betweenVertical0fa8ed46940ffb0b40e92112c3bb5117.png"},function(e,t,i){e.exports=i.p+"images/stone_connectedBottomAndRight8853bd17731c3da6469566ae81ac86eb.png"},function(e,t,i){e.exports=i.p+"images/stone_connectedBottomAndLeft2d0d1517c16a635f1cf88794aea50b78.png"},function(e,t,i){e.exports=i.p+"images/stone_connectedTopAndLefte4f30c376a7d801637aef9b31e930b61.png"},function(e,t,i){e.exports=i.p+"images/stone_connectedTopAndRight0a8ce7f24cb6bb02ecc7760ff51b53d8.png"},function(e,t,i){e.exports=i.p+"images/stone_connectedAllcea47e078b48229b4f5521d0aefc3fa1.png"},function(e,t,i){e.exports=i.p+"images/stone_betweenVertical_connectedLeftb70cfaea10c2845ab31e8b7a0ea7d81e.png"},function(e,t,i){e.exports=i.p+"images/stone_betweenVertical_connectedRight1a92a44c4aa5ed6fedf011e2d48550b3.png"},function(e,t,i){e.exports=i.p+"images/stone_betweenHorizontal_connectedTopb680910a072ca770c146a7da80b5f968.png"},function(e,t,i){e.exports=i.p+"images/stone_betweenHorizontal_connectedBottom0096561effda01952033463a7c317b8c.png"},function(e,t,i){e.exports=i.p+"images/cell4bda028508a52dd3adf210d58377467d.png"},function(e,t,i){e.exports=i.p+"images/player1_anim1_right9bfd7ee41213f2b0d23c74bc007407e0.png"},function(e,t,i){e.exports=i.p+"images/player1_anim2_right93e98b2990c304402f842e201d1bb7bf.png"},function(e,t,i){e.exports=i.p+"images/player1_anim3_right9eca4886517844d4c1a305e07a6f1115.png"},function(e,t,i){e.exports=i.p+"images/player1_anim4_rightfb5bd7c62007dec510cca01da7a899b2.png"},function(e,t,i){e.exports=i.p+"images/player1_anim5_rightf7838ce0a537ad5af948f0456dcbc121.png"},function(e,t,i){e.exports=i.p+"images/player1_anim6_rightec1634d5b0f7c26fae439e1aed6e415b.png"},function(e,t,i){e.exports=i.p+"images/player1_anim1_left74c51faf5445f93500a60b19df0e5a60.png"},function(e,t,i){e.exports=i.p+"images/player1_anim2_leftee23cf4539e17c1d6f1c61faf26ff28f.png"},function(e,t,i){e.exports=i.p+"images/player1_anim3_lefta4c029cb1b495f9e5e7b283ade93f035.png"},function(e,t,i){e.exports=i.p+"images/player1_anim4_left78912436b9af436f1f0a39aa452c5f92.png"},function(e,t,i){e.exports=i.p+"images/player1_anim5_left4b614f7b9a920a93a425f140849dc866.png"},function(e,t,i){e.exports=i.p+"images/player1_anim6_left487edb28d9709968bf913ea3ace284a6.png"},function(e,t,i){e.exports=i.p+"images/player1_stop_left047f294e8721689677ee3d9ba0e09c36.png"},function(e,t,i){e.exports=i.p+"images/player1_stop_right3a87b216056a94be56b079b064e807f5.png"},function(e,t,i){e.exports=i.p+"images/coin1174086130a29db6bd8b68eb8d4ea3944.png"},function(e,t,i){e.exports=i.p+"images/coin21014ba4e51873018ada0e0e85694068e.png"},function(e,t,i){e.exports=i.p+"images/coin3777c81244a45759066080a7ebc97ddc0.png"},function(e,t,i){e.exports=i.p+"images/coin41022d70d9b4eea50c95a7d52baddfe70.png"},function(e,t,i){e.exports=i.p+"images/coin5aa0cd54f2f444f6d5e26cbd797d5085e.png"},function(e,t,i){e.exports=i.p+"images/coin6d2318616b4617445adf4057d29149b13.png"},function(e,t,i){e.exports=i.p+"images/trap136f832c521207ef3736e296742c1406e.png"},function(e,t,i){e.exports=i.p+"images/trap262e702b493194bc9124e141c15fa01c9.png"},function(e,t,i){e.exports=i.p+"images/trap30b734cdd970ea5ee118791a1f9c6354a.png"},function(e,t,i){e.exports=i.p+"images/trap4efecbf66c8494d6f0d7b14957bd8e47f.png"},function(e,t,i){e.exports=i.p+"sounds/coin276507ac96a9c75bc2ab6f40f74a19547.mp3"},function(e,t,i){},function(e,t,i){"use strict";i.r(t);i(44);var n=i(2),a=i.n(n),s=i(3),o=i.n(s),r=i(4),c=i.n(r),p=i(5),l=i.n(p),h=i(6),f=i.n(h),d=i(7),u=i.n(d),m=i(8),g=i.n(m),b=i(9),v=i.n(b),w=i(10),y=i.n(w),S=i(11),_=i.n(S),C=i(12),k=i.n(C),L=i(13),I=i.n(L),x=i(14),j=i.n(x),E=i(15),O=i.n(E),Y=i(16),P=i.n(Y),X=i(17),T=i.n(X),A=i(18),G=i.n(A),z=i(19),R=i.n(z),H=i(20),B=i.n(H),F=i(21),M=i.n(F),D=i(22),W=i.n(D),N=i(23),V=i.n(N),$=i(24),q=i.n($),K=i(25),U=i.n(K),J=i(26),Q=i.n(J),Z=i(27),ee=i.n(Z),te=i(28),ie=i.n(te),ne=i(29),ae=i.n(ne),se=i(30),oe=i.n(se),re=i(31),ce=i.n(re),pe=i(32),le=i.n(pe),he=i(33),fe=i.n(he),de=i(34),ue=i.n(de),me=i(35),ge=i.n(me),be=i(36),ve=i.n(be),we=i(37),ye=i.n(we),Se=i(38),_e=i.n(Se),Ce=i(39),ke=i.n(Ce),Le=i(40),Ie=i.n(Le),xe=i(41),je=i.n(xe),Ee=i(42),Oe=i.n(Ee),Ye=i(43),Pe=i.n(Ye);function Xe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Te(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ae(e,t,i){return t&&Te(e.prototype,t),i&&Te(e,i),e}var Ge=new Image;Ge.src=a.a;var ze=new Image;ze.src=o.a;var Re=new Image;Re.src=c.a;var He=new Image;He.src=l.a;var Be=new Image;Be.src=f.a;var Fe=new Image;Fe.src=u.a;var Me=new Image;Me.src=g.a;var De=new Image;De.src=v.a;var We=new Image;We.src=y.a;var Ne=new Image;Ne.src=_.a;var Ve=new Image;Ve.src=k.a;var $e=new Image;$e.src=I.a;var qe=new Image;qe.src=j.a;var Ke=new Image;Ke.src=O.a;var Ue=new Image;Ue.src=P.a;var Je=new Image;Je.src=T.a;var Qe=new Image;Qe.src=G.a;var Ze=new Image;Ze.src=R.a;var et=new Image;et.src=B.a;var tt=new Image;tt.src=M.a;var it=new Image;it.src=W.a;var nt=new Image;nt.src=V.a;var at=new Image;at.src=q.a;var st=new Image;st.src=U.a;var ot=new Image;ot.src=Q.a;var rt=new Image;rt.src=ee.a;var ct=new Image;ct.src=ie.a;var pt=new Image;pt.src=ae.a;var lt=new Image;lt.src=oe.a;var ht=new Image;ht.src=ce.a;var ft=new Image;ft.src=le.a;var dt=new Image;dt.src=fe.a;var ut=new Image;ut.src=ue.a;var mt=new Image;mt.src=ge.a;var gt=new Image;gt.src=ve.a;var bt=new Image;bt.src=ye.a;var vt=new Image;vt.src=_e.a;var wt=new Image;wt.src=ke.a;var yt=new Image;yt.src=Ie.a;var St=new Image;St.src=je.a;var _t=new Image;function Ct(e,t,i,n,a,s){var o={type:t,id:t+e,visible:!0,material:n,posX:a,posY:s,eventList:[],sprite:null,spriteList:[],animateSpriteCount:0,animateSpeedCount:0,animateSpeed:1,spriteWidth:0,spriteHeight:0,spriteOffsetX:0,spriteOffsetY:0};return o.die=function(){window.Game.removeObject(this)}.bind(o),o.staticAnimate=function(){this.animateSpeedCount===this.animateSpeed?(this.animateSpeedCount=0,this.animateSpriteCount===this.spriteList.length-1?this.animateSpriteCount=0:this.animateSpriteCount+=1,this.sprite=this.spriteList.getSprite(this.animateSpriteCount,this.direction)):this.animateSpeedCount+=1}.bind(o),o.moveAnimate=function(){if(!this.moves)return this.animateSpriteCount=0,this.animateSpeedCount=0,void(this.sprite=this.spriteList.getStopSprite(this.direction));this.animateSpeedCount===this.animateSpeed?(this.animateSpeedCount=0,this.animateSpriteCount===this.spriteList.length-1?this.animateSpriteCount=0:this.animateSpriteCount+=1,this.sprite=this.spriteList.getSprite(this.animateSpriteCount,this.direction)):this.animateSpeedCount+=1}.bind(o),i instanceof Yt?i.default?(o.spriteList=i,o.sprite=i.default[0],o.eventList.push(new Ot("staticAnimate",o.staticAnimate,!1))):(o.spriteList=i,o.sprite=i.right[0],o.eventList.push(new Ot("moveAnimate",o.moveAnimate,!1))):i.length?(o.spriteList=i,o.sprite=i[0]):o.sprite=i,o.addEvent=function(t,e,i,n){n&&(this.eventList=this.eventList.filter(function(e){return e.id!=="event"+t})),this.eventList.push(new Ot(t||this.eventList.length,e,i))}.bind(o),o.addEventToStart=function(t,e,i,n){n&&(this.eventList=this.eventList.filter(function(e){return e.id!=="event"+t})),this.eventList.unshift(new Ot(t||this.eventList.length,e,i))}.bind(o),o.startEvents=function(){var t=[];0<this.eventList.length&&(this.eventList.forEach(function(e){e.func(),e.removable||t.push(e)}),this.eventList=t)}.bind(o),o.checkClash=function(e,t){if(e.id!==this.id){var i,n,a=t/2,s=this.posX-a,o=this.posX+a,r=this.posY-a,c=this.posY+a,p=e.posX-a,l=e.posX+a,h=e.posY-a,f=e.posY+a;if(h<c&&r<f&&s<l&&p<o)if(this.clash(e),e.clash(this),"stone"===this.type)switch(i=this.posX<e.posX?"right":this.posX>e.posX?"left":"one level",n=this.posY<e.posY?"bottom":this.posY>e.posY?"top":"one level",Math.abs(this.posX-e.posX)>Math.abs(this.posY-e.posY)?i:n){case"right":"left"===e.direction&&(e.addEventToStart("stop",e.stopMove,!0),e.posX+=e.speed);break;case"left":"right"===e.direction&&(e.addEventToStart("stop",e.stopMove,!0),e.posX-=e.speed);break;case"bottom":"top"===e.direction&&(e.addEventToStart("stop",e.stopMove,!0),e.posY+=e.speed);break;case"top":"bottom"===e.direction&&(e.addEventToStart("stop",e.stopMove,!0),e.posY-=e.speed)}}}.bind(o),o.clash=function(e){}.bind(o),o}function kt(e,t,i,n,a,s,o){var r=new Ct(e,t,i,!0,n,a);return r.hp=s||100,r.direction="top",r.moves=!1,r.speed=o||1,r.spawnPosX=n,r.spawnPosY=a,r.changeDirection=function(t){if(("left"!==this.direction&&"right"!==this.direction||"left"!==t&&"right"!==t)&&("top"!==this.direction&&"bottom"!==this.direction||"top"!==t&&"bottom"!==t))this.addEventToStart("tryChangeDirection",function(){var e=window.Game.findCell({object:{posX:r.posX,posY:r.posY},direction:t});r.posX/20%2==1&&r.posY/20%2==1&&e&&0<e.objects.length&&"stone"!==e.objects[0].type&&(r.direction=t,this.removable=!0)},!1,!0);else{this.direction=t;var e=this.eventList.find(function(e){return"eventtryChangeDirection"===e.id});e&&(e.removable=!0)}}.bind(r),r.startMove=function(){this.moves=!0}.bind(r),r.stopMove=function(){this.moves=!1}.bind(r),r.move=function(){if(this.moves)switch(this.direction){case"left":this.posX-=this.speed;break;case"right":this.posX+=this.speed;break;case"top":this.posY-=this.speed;break;case"bottom":this.posY+=this.speed}}.bind(r),r}function Lt(e,t,i,n,a){var s=new kt(e,"player",new Yt({left:[st,ot,rt,ct,pt,lt],right:[Ze,et,tt,it,nt,at],stop:{left:ht,right:ft}}),t,i,3,5);return s.nickName=n||"Unamed",s.score=a||0,s.eventList.push(new Ot("move",s.move,!1)),s.spriteWidth=49,s.spriteHeight=53,s.spriteOffsetX=0,s.spriteOffsetY=-6,s.killed=!1,s.rebornTime=10,s.rebornCounter=0,s.reborn=function(e,t){this.rebornCounter=this.rebornTime-(window.Game.getGameTime()-e),0===this.rebornCounter&&(this.posX=this.spawnPosX,this.posY=this.spawnPosY,this.killed=!1,this.material=!0,this.visible=!0,t.removable=!0)},s.kill=function(){this.killed=!0,this.material=!1,this.visible=!1,this.moves=!1;var e=window.Game.getGameTime();0<this.hp&&(this.hp-=1),0<this.hp&&(this.rebornCounter=this.rebornTime,this.addEventToStart("reborn",function(){s.reborn(e,this)},!1,!0))}.bind(s),s.upScore=function(e){this.score+=e}.bind(s),s.clash=function(e){"coin"===e.type&&this.upScore(1)}.bind(s),s.control=function(e){if(!this.killed)switch(e){case"up":this.changeDirection("top"),this.startMove();break;case"right":this.changeDirection("right"),this.startMove();break;case"down":this.changeDirection("bottom"),this.startMove();break;case"left":this.changeDirection("left"),this.startMove();break;case"stop":this.stopMove()}}.bind(s),s}function It(e,t,i){var n=new Ct(e,"stone",Ge,!0,t,i);return n.spriteWidth=40,n.spriteHeight=52,n.spriteOffsetY=-6,n.stoneSprites={isolated:Ge,connectedLeft:ze,connectedRight:Re,connectedTop:He,connectedBottom:Be,betweenHorizontal:Fe,betweenVertical:Me,connectedBottomAndRight:De,connectedBottomAndLeft:We,connectedTopAndLeft:Ne,connectedTopAndRight:Ve,connectedAll:$e,betweenVerticalConnectedRight:Ke,betweenVerticalConnectedLeft:qe,betweenHorizontalConnectedBottom:Je,betweenHorizontalConnectedTop:Ue},n.setSprite=function(e){this.stoneSprites[e]&&(this.sprite=this.stoneSprites[e])}.bind(n),n}function xt(e,t,i){var n=new Ct(e,"coin",new Yt([dt,ut,mt,gt,bt,vt]),!0,t,i);return n.spriteWidth=25,n.spriteHeight=28,n.spriteOffsetY=-15,n.animateSpeed=2,n.clash=function(e){if("player"===e.type){var t=new Audio;t.src=Pe.a,t.volume=.005,t.play(),this.die()}}.bind(n),n}function jt(e,t,i,n){var a=new Ct(e,"trap",new Yt([wt,yt,St,_t,St,yt]),!0,t,i);return a.active=!1,a.animateSpeed=1,a.staticAnimate=function(){a.active=3===this.animateSpriteCount||2===this.animateSpriteCount,0===this.animateSpriteCount||3===this.animateSpriteCount?this.animateSpeedCount===this.animateSpeed*n?(this.animateSpriteCount+=1,this.animateSpeedCount=0):this.animateSpeedCount+=1:this.animateSpeedCount===this.animateSpeed?(this.animateSpeedCount=0,this.animateSpriteCount===this.spriteList.length-1?this.animateSpriteCount=0:this.animateSpriteCount+=1,this.sprite=this.spriteList.getSprite(this.animateSpriteCount,this.direction)):this.animateSpeedCount+=1}.bind(a),a.addEvent("staticAnimate",a.staticAnimate,!1,!0),a.clash=function(e){this.active&&"player"===e.type&&e.kill()}.bind(a),a}_t.src=Oe.a;var Et=function(){function s(e,t,i,n,a){Xe(this,s),this.id="cell"+e,this.posX=t,this.posY=i,this.objects=[],this.sprite=Qe,this.visible=!0,this.fieldPosRow=n,this.fieldPosColumn=a}return Ae(s,[{key:"set",value:function(e){this.objects.push(e),e.posX=this.posX,e.posY=this.posY,"player"===e.type&&(e.spawnPosX=this.posX,e.spawnPosY=this.posY)}},{key:"clear",value:function(e){e&&this.objects.forEach(function(e){e.die()}),this.objects=[]}}]),s}(),Ot=function e(t,i,n){Xe(this,e),this.id="event"+t,this.func=i,this.removable=void 0===n||n},Yt=function(){function t(e){Xe(this,t),e.length?(this.default=e,this.length=e.length):(this.right=e.right,this.left=e.left,e.stop&&(this.stop={right:e.stop.right,left:e.stop.left}),this.length=e.left.length),this.lastDirection="right"}return Ae(t,[{key:"getStopSprite",value:function(e){return"right"===e?(this.lastDirection=e,this.stop.right):"left"===e?(this.lastDirection=e,this.stop.left):this.getStopSprite(this.lastDirection)}},{key:"getSprite",value:function(e,t){return t?"right"===t?(this.lastDirection=t,this.right[e]):"left"===t?(this.lastDirection=t,this.left[e]):this.getSprite(e,this.lastDirection):this.default[e]}}]),t}(),Pt=[new function e(t,i,n,a,s){Xe(this,e),this.stoneList=t,this.traps=i,this.playersFieldCoords=n,this.mobSpawnPoints=a,this.holesInBaseStones=s}([[1,5],[1,8],[1,9],[1,11],[1,13],[1,14],[1,17],[2,2],[2,3],[2,5],[2,7],[2,8],[2,11],[2,14],[2,15],[2,17],[2,19],[2,20],[3,2],[3,7],[3,8],[3,10],[3,11],[3,12],[3,14],[3,15],[3,20],[4,4],[4,5],[4,17],[4,18],[5,1],[5,7],[5,8],[5,9],[5,11],[5,13],[5,14],[5,15],[5,21],[6,3],[6,5],[6,9],[6,11],[6,13],[6,17],[6,19],[7,1],[7,2],[7,3],[7,5],[7,6],[7,11],[7,16],[7,17],[7,19],[7,20],[7,21],[8,8],[8,9],[8,10],[8,11],[8,12],[8,13],[8,14],[9,1],[9,2],[9,3],[9,5],[9,6],[9,16],[9,17],[9,19],[9,20],[9,21],[10,3],[10,5],[10,8],[10,10],[10,12],[10,14],[10,17],[10,19],[11,7],[11,8],[11,10],[11,12],[11,14],[11,15],[12,2],[12,4],[12,5],[12,17],[12,18],[12,20],[13,2],[13,4],[13,5],[13,7],[13,8],[13,10],[13,11],[13,12],[13,14],[13,15],[13,17],[13,18],[13,20],[14,2],[14,4],[14,5],[14,7],[14,10],[14,11],[14,12],[14,15],[14,17],[14,18],[14,20],[15,7],[15,9],[15,10],[15,11],[15,12],[15,13],[15,15]],[[3,5],[3,17],[4,11],[8,5],[8,6],[8,16],[8,17],[10,11],[11,11],[13,3],[13,19]],[[1,1],[1,21]],[],[[8,0],[8,22]])],Xt=i(0),Tt=i(1),At=i.n(Tt);function Gt(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function zt(e){return function(e){if(Array.isArray(e)){for(var t=0,i=new Array(e.length);t<e.length;t++)i[t]=e[t];return i}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Rt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ht(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Bt(e,t,i){return t&&Ht(e.prototype,t),i&&Ht(e,i),e}var Ft=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$gameWindow=document.querySelector(".canvasWrapper"),this.$interface=document.querySelector(".live_interface"),this.$playerInfoBlocks=[]}return function(e,t,i){t&&Gt(e.prototype,t),i&&Gt(e,i)}(e,[{key:"gamePause",value:function(){this.$gameWindow.classList.toggle("pause")}},{key:"touchHandler",value:function(){}},{key:"setControls",value:function(t){document.addEventListener("keydown",function(e){return t(e)})}},{key:"createInterface",value:function(e){var f=this;e.players.forEach(function(e,t){var i=document.createElement("div"),n=document.createElement("span"),a=document.createElement("div"),s=new Image,o=document.createElement("div"),r=document.createElement("div"),c=document.createElement("span"),p=document.createElement("div");i.className="player_info player_info--".concat(e.id),a.className="player_info__avatar_wrapper",s.src=e.sprite.src,s.className="player_info__avatar",o.className="player_info__avatar_progress_bar",a.append(o),a.append(s),r.className="player_info__player_data",c.textContent=e.nickName,c.className="player_data__nickname",p.className="player_data__heaths",n.className="player_info__score",n.innerHTML="$<span class='score_value'>".concat(e.score,"</span>");for(var l=0;l<e.hp;l++){var h=new Image;h.src=At.a,h.className="heath",p.append(h)}r.append(c),r.append(p),r.append(n),i.append(a),i.append(r),f.$interface.append(i),f.$playerInfoBlocks.push(i)})}},{key:"interfaceReload",value:function(e){var c=this;e.players.forEach(function(t){var e=c.$playerInfoBlocks.find(function(e){return e.classList.contains("player_info--".concat(t.id))}),i=e.querySelector(".score_value"),n=e.querySelector(".player_info__avatar_progress_bar");if(i.textContent=t.score,e.getElementsByClassName("heath").length!==t.hp){var a=e.querySelector(".player_data__heaths");a.innerHTML="";for(var s=0;s<t.hp;s++){var o=new Image;o.src=At.a,o.className="heath",a.append(o)}}if(t.killed?n.classList.contains("active")||(n.classList.add("active"),n.style="width: 100%"):n.classList.contains("active")&&setTimeout(function(){n.classList.remove("active")},500),0<t.hp)if(0<t.rebornCounter){var r=t.rebornCounter/t.rebornTime*100;n.style="width: ".concat(r,"%")}else n.style="width: 0"})}}]),e}()),Mt=function(){function e(){Rt(this,e),this.canvas=document.querySelector("#canvas"),this.ctx=this.canvas.getContext("2d"),this.windowWidth=this.canvas.clientWidth,this.windowHeight=this.canvas.clientHeight,this.cellSize=40,this.drawBackground()}return Bt(e,[{key:"drawObject",value:function(e){if(e.visible){var t=e.spriteWidth,i=e.spriteHeight,n=e.posX-this.cellSize/2,a=e.posY-this.cellSize/2;t&&i&&(n=e.posX-t/2,a=e.posY-i/2),e.spriteOffsetX&&(n+=e.spriteOffsetX),e.spriteOffsetY&&(a+=e.spriteOffsetY);try{this.ctx.drawImage(e.sprite,n,a,t||this.cellSize,i||this.cellSize)}catch(e){}}}},{key:"drawCell",value:function(e){e.object&&e.object.visible&&this.drawObject(e.object)}},{key:"drawBackground",value:function(){this.ctx.fillStyle="black",this.ctx.fillRect(0,0,this.windowWidth,this.windowHeight)}}]),e}();(new(function(){function t(e){Rt(this,t),(window.Game=this).eventList=[],this.Graphic=new Mt,this.gameInterval=null,this.gameField=[],this.gameSpeed=30,this.paused=!1,this.gameTime=0,this.gameTimer=null,this.stones=[],this.players=[],this.mobs=[],this.loot=[],this.traps=[],this.trapDuration=40,this.mapList=Pt,this.allObjects=[].concat(zt(this.stones),zt(this.players),zt(this.mobs)),this.mapCreate(this.mapList[0]),this.setControls(),Ft.createInterface({players:this.players})}return Bt(t,[{key:"addObject",value:function(e,t){switch(t){case"stone":this.stones.push(e);break;case"player":this.players.push(e);break;case"mobs":this.mobs.push(e);break;case"loot":this.loot.push(e);break;case"trap":this.traps.push(e)}this.allObjects.push(e)}},{key:"removeObject",value:function(t){switch(this.allObjects=this.allObjects.filter(function(e){return e.id!==t.id}),t.type){case"stone":this.stones=this.stones.filter(function(e){return e.id!==t.id}),this.stonePositionAnalyse();break;case"player":this.players=this.players.filter(function(e){return e.id!==t.id});break;case"mob":this.mobs=this.mobs.filter(function(e){return e.id!==t.id});break;case"loot":this.loot=this.loot.filter(function(e){return e.id!==t.id});break;case"trap":this.traps=this.traps.filter(function(e){return e.id!==t.id});break;default:this.loot=this.loot.filter(function(e){return e.id!==t.id})}}},{key:"setControls",value:function(){var a=this;Ft.setControls(function(e){var t=Xt.player1,i=Xt.player2,n=Xt.global;if(!a.paused)switch(e.code){case t.up:a.players[0].control("up");break;case t.right:a.players[0].control("right");break;case t.down:a.players[0].control("down");break;case t.left:a.players[0].control("left");break;case t.stop:a.players[0].control("stop");break;case i.up:a.players[1].control("up");break;case i.right:a.players[1].control("right");break;case i.down:a.players[1].control("down");break;case i.left:a.players[1].control("left");break;case i.stop:a.players[1].control("stop")}e.code===n.pause&&(a.paused?a.start():a.pause(),Ft.gamePause())})}},{key:"findCell",value:function(t){var i,n,e,a=[];this.gameField.forEach(function(e){e.forEach(function(e){return a.push(e)})});var s=this.Graphic.cellSize/2;if(t.fieldPosRow&&t.fieldPosColumn)e=a.find(function(e){return e.fieldPosRow===t.fieldPosRow&&e.fieldPosColumn===t.fieldPosColumn});else if(t.posX&&t.posY)i=t.posX,n=t.posY,e=a.find(function(e){return e.posX-s<=i&&e.posX+s>=i&&e.posY-s<=n&&e.posY+s>=n});else if(t.object&&t.direction){i=t.object.posX,n=t.object.posY;var o=a.find(function(e){return e.posX-s<=i&&e.posX+s>=i&&e.posY-s<=n&&e.posY+s>=n});if(!o)return null;switch(t.direction){case"top":e=this.findCell({fieldPosRow:o.fieldPosRow-1,fieldPosColumn:o.fieldPosColumn});break;case"right":e=this.findCell({fieldPosRow:o.fieldPosRow,fieldPosColumn:o.fieldPosColumn+1});break;case"bottom":e=this.findCell({fieldPosRow:o.fieldPosRow+1,fieldPosColumn:o.fieldPosColumn});break;case"left":e=this.findCell({fieldPosRow:o.fieldPosRow,fieldPosColumn:o.fieldPosColumn-1})}}return e}},{key:"stonePositionAnalyse",value:function(){var a=function(e,t){return this.gameField[e]&&this.gameField[e][t]&&0<this.gameField[e][t].objects.length&&"stone"===this.gameField[e][t].objects[0].type}.bind(this);this.gameField.forEach(function(e,n){e.forEach(function(e,t){if(0<e.objects.length&&"stone"===e.objects[0].type){var i=e.objects[0];a(n-1,t)&&a(n+1,t)&&a(n,t-1)&&a(n,t+1)?i.setSprite("connectedAll"):a(n-1,t)&&a(n+1,t)&&a(n,t+1)?i.setSprite("betweenVerticalConnectedRight"):a(n-1,t)&&a(n+1,t)&&a(n,t-1)?i.setSprite("betweenVerticalConnectedLeft"):a(n,t-1)&&a(n,t+1)&&a(n+1,t)?i.setSprite("betweenHorizontalConnectedBottom"):a(n,t-1)&&a(n,t+1)&&a(n-1,t)?i.setSprite("betweenHorizontalConnectedTop"):a(n+1,t)&&a(n,t+1)?i.setSprite("connectedBottomAndRight"):a(n+1,t)&&a(n,t-1)?i.setSprite("connectedBottomAndLeft"):a(n-1,t)&&a(n,t+1)?i.setSprite("connectedTopAndRight"):a(n-1,t)&&a(n,t-1)?i.setSprite("connectedTopAndLeft"):a(n,t+1)&&a(n,t-1)?i.setSprite("betweenHorizontal"):a(n+1,t)&&a(n-1,t)?i.setSprite("betweenVertical"):a(n-1,t)?i.setSprite("connectedTop"):a(n,t-1)?i.setSprite("connectedLeft"):a(n+1,t)?i.setSprite("connectedBottom"):a(n,t+1)&&i.setSprite("connectedRight")}})})}},{key:"addStone",value:function(e,t,i){var n;n=i||new It("".concat(e,"_").concat(t)),this.addObject(n,"stone"),this.gameField[e][t].set(n)}},{key:"addStones",value:function(e){var a=this;e.forEach(function(e){var t=e[0],i=e[1],n=new It("".concat(t,"_").concat(i));a.addObject(n,"stone"),a.gameField[t][i].set(n)})}},{key:"mapCreate",value:function(e){for(var a=this,t=0;t<this.Graphic.windowHeight/this.Graphic.cellSize;t++){this.gameField[t]=[];for(var i=0;i<this.Graphic.windowWidth/this.Graphic.cellSize;i++)if(this.gameField[t][i]=new Et("".concat(t,"_").concat(i),i*this.Graphic.cellSize+this.Graphic.cellSize/2,t*this.Graphic.cellSize+this.Graphic.cellSize/2,t,i),0===t||t===this.Graphic.windowHeight/this.Graphic.cellSize-1||0===i||i===this.Graphic.windowWidth/this.Graphic.cellSize-1){var n=new It("".concat(t,"_").concat(i));0===t||t===this.Graphic.windowHeight/this.Graphic.cellSize-1?0<i&&i<this.Graphic.windowWidth/this.Graphic.cellSize-1?n.setSprite("betweenHorizontal"):0===i?0===t?n.setSprite("connectedBottomAndRight"):n.setSprite("connectedTopAndRight"):0===t?n.setSprite("connectedBottomAndLeft"):n.setSprite("connectedTopAndLeft"):n.setSprite("betweenVertical"),this.addObject(n,"stone"),this.gameField[t][i].set(n)}}this.addStones(e.stoneList),e.holesInBaseStones.forEach(function(e){a.gameField[e[0]][e[1]].clear(!0)}),e.traps.forEach(function(e){var t=new jt("".concat(e[0],"_").concat(e[1]),null,null,a.trapDuration);a.addObject(t,"trap"),a.gameField[e[0]][e[1]].set(t)}),e.playersFieldCoords.forEach(function(e,t){a.players[t]||(a.addObject(new Lt(t,null,null,"player".concat(t+1)),"player"),a.gameField[e[0]][e[1]].set(a.players[t]))}),this.stonePositionAnalyse(),this.gameField.forEach(function(e,n){e.forEach(function(e,t){if(0===e.objects.length){var i=new xt("".concat(n,"_").concat(t),e.posX,e.posY);a.addObject(i,"loot"),e.set(i)}})})}},{key:"drawFrame",value:function(){var t=this;this.gameField.forEach(function(e){return e.forEach(function(e){t.Graphic.drawObject(e)})}),this.allObjects=this.allObjects.sort(function(e,t){return e.posY-t.posY}),this.traps.forEach(function(e){return t.Graphic.drawObject(e)}),this.allObjects.forEach(function(e){"trap"!==e.type&&t.Graphic.drawObject(e)})}},{key:"checkOverflow",value:function(){var t=this;[].concat(zt(this.mobs),zt(this.players)).forEach(function(e){e.posX>t.Graphic.windowWidth+t.Graphic.cellSize?e.posX=0-t.Graphic.cellSize:e.posX<0-t.Graphic.cellSize?e.posX=t.Graphic.windowWidth+t.Graphic.cellSize:e.posY>t.Graphic.windowHeight+t.Graphic.cellSize?e.posY=0-t.Graphic.cellSize:e.posY<0-t.Graphic.cellSize&&(e.posY=t.Graphic.windowHeight+t.Graphic.cellSize)})}},{key:"checkClash",value:function(){var i=this,e=[].concat(zt(this.mobs),zt(this.players));this.allObjects.forEach(function(t){e.forEach(function(e){t.material&&e.material&&t.checkClash(e,i.Graphic.cellSize)})})}},{key:"getGameTime",value:function(){return this.gameTime}},{key:"start",value:function(){var e=this;this.paused=!1,this.gameInterval=setInterval(function(){e.checkClash(),e.eventList.forEach(function(e){return e()}),e.eventList=[],e.allObjects.forEach(function(e){e.eventList&&0<e.eventList.length&&e.startEvents()}),e.checkOverflow(),e.drawFrame(),Ft.interfaceReload({players:e.players})},1/this.gameSpeed*1e3),this.gameTimer=setInterval(function(){return e.gameTime+=1},1e3)}},{key:"pause",value:function(){this.paused=!0,clearInterval(this.gameInterval),clearInterval(this.gameTimer)}}]),t}())).start()}]);