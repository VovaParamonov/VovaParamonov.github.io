!function(i){var n={};function s(e){if(n[e])return n[e].exports;var t=n[e]={i:e,l:!1,exports:{}};return i[e].call(t.exports,t,t.exports,s),t.l=!0,t.exports}s.m=i,s.c=n,s.d=function(e,t,i){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)s.d(i,n,function(e){return t[e]}.bind(null,n));return i},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=36)}([function(e){e.exports=JSON.parse('{"global":{"pause":"Escape"},"player1":{"up":"ArrowUp","right":"ArrowRight","down":"ArrowDown","left":"ArrowLeft","stop":"Space"},"player2":{"up":"KeyW","right":"KeyD","down":"KeyS","left":"KeyA","stop":"ControlLeft"}}')},function(e,t,i){e.exports=i.p+"images/stone_isolatedf766b84add7bd266b809a19b2158bafe.png"},function(e,t,i){e.exports=i.p+"images/stone_connectedLeft0b5e51f52c3eaecc2a2b5b38df8247ab.png"},function(e,t,i){e.exports=i.p+"images/stone_connectedRight8f122b3becac4bc7be01af9bdafae204.png"},function(e,t,i){e.exports=i.p+"images/stone_connectedTop4983cdde0a3366a0a2379a802e05f761.png"},function(e,t,i){e.exports=i.p+"images/stone_connectedBottomc00c9ef8005ec43a0363004f8a2fda0f.png"},function(e,t,i){e.exports=i.p+"images/stone_betweenHorizontalef1645cac49b19b51382348607379886.png"},function(e,t,i){e.exports=i.p+"images/stone_betweenVertical1b55a024e4cd73e556ed6346bdd73f9f.png"},function(e,t,i){e.exports=i.p+"images/stone_connectedBottomAndRight5b081bb564e30da9ede2ee0d83e57c56.png"},function(e,t,i){e.exports=i.p+"images/stone_connectedBottomAndLeft9e16826d1140477b3e6c57e768ff9b1b.png"},function(e,t,i){e.exports=i.p+"images/stone_connectedTopAndLeftdd876f217975b84e7a94a9a880ba5fc2.png"},function(e,t,i){e.exports=i.p+"images/stone_connectedTopAndRight2eefc775c83b758d54304fa4110a2e4e.png"},function(e,t,i){e.exports=i.p+"images/stone_connectedAll2ab69903dc68272fda2d84973d5c2dd1.png"},function(e,t,i){e.exports=i.p+"images/celldfb124e005f1daa9277a9dc5cb90f846.png"},function(e,t,i){e.exports=i.p+"images/player1_anim1_right9bfd7ee41213f2b0d23c74bc007407e0.png"},function(e,t,i){e.exports=i.p+"images/player1_anim2_right93e98b2990c304402f842e201d1bb7bf.png"},function(e,t,i){e.exports=i.p+"images/player1_anim3_right9eca4886517844d4c1a305e07a6f1115.png"},function(e,t,i){e.exports=i.p+"images/player1_anim4_rightfb5bd7c62007dec510cca01da7a899b2.png"},function(e,t,i){e.exports=i.p+"images/player1_anim5_rightf7838ce0a537ad5af948f0456dcbc121.png"},function(e,t,i){e.exports=i.p+"images/player1_anim6_rightec1634d5b0f7c26fae439e1aed6e415b.png"},function(e,t,i){e.exports=i.p+"images/player1_anim1_left74c51faf5445f93500a60b19df0e5a60.png"},function(e,t,i){e.exports=i.p+"images/player1_anim2_leftee23cf4539e17c1d6f1c61faf26ff28f.png"},function(e,t,i){e.exports=i.p+"images/player1_anim3_lefta4c029cb1b495f9e5e7b283ade93f035.png"},function(e,t,i){e.exports=i.p+"images/player1_anim4_left78912436b9af436f1f0a39aa452c5f92.png"},function(e,t,i){e.exports=i.p+"images/player1_anim5_left4b614f7b9a920a93a425f140849dc866.png"},function(e,t,i){e.exports=i.p+"images/player1_anim6_left487edb28d9709968bf913ea3ace284a6.png"},function(e,t,i){e.exports=i.p+"images/player1_stop_left047f294e8721689677ee3d9ba0e09c36.png"},function(e,t,i){e.exports=i.p+"images/player1_stop_right3a87b216056a94be56b079b064e807f5.png"},function(e,t,i){e.exports=i.p+"images/coin1174086130a29db6bd8b68eb8d4ea3944.png"},function(e,t,i){e.exports=i.p+"images/coin21014ba4e51873018ada0e0e85694068e.png"},function(e,t,i){e.exports=i.p+"images/coin3777c81244a45759066080a7ebc97ddc0.png"},function(e,t,i){e.exports=i.p+"images/coin41022d70d9b4eea50c95a7d52baddfe70.png"},function(e,t,i){e.exports=i.p+"images/coin5aa0cd54f2f444f6d5e26cbd797d5085e.png"},function(e,t,i){e.exports=i.p+"images/coin6d2318616b4617445adf4057d29149b13.png"},function(e,t,i){e.exports=i.p+"sounds/coin276507ac96a9c75bc2ab6f40f74a19547.mp3"},function(e,t,i){},function(e,t,i){"use strict";i.r(t);i(35);var n=i(1),s=i.n(n),o=i(2),a=i.n(o),r=i(3),c=i.n(r),p=i(4),l=i.n(p),h=i(5),f=i.n(h),d=i(6),u=i.n(d),g=i(7),m=i.n(g),b=i(8),v=i.n(b),w=i(9),y=i.n(w),S=i(10),k=i.n(S),_=i(11),C=i.n(_),j=i(12),L=i.n(j),I=i(13),x=i.n(I),O=i(14),Y=i.n(O),A=i(15),X=i.n(A),E=i(16),P=i.n(E),G=i(17),z=i.n(G),R=i(18),T=i.n(R),F=i(19),B=i.n(F),H=i(20),M=i.n(H),W=i(21),D=i.n(W),$=i(22),q=i.n($),K=i(23),N=i.n(K),V=i(24),U=i.n(V),J=i(25),Q=i.n(J),Z=i(26),ee=i.n(Z),te=i(27),ie=i.n(te),ne=i(28),se=i.n(ne),oe=i(29),ae=i.n(oe),re=i(30),ce=i.n(re),pe=i(31),le=i.n(pe),he=i(32),fe=i.n(he),de=i(33),ue=i.n(de),ge=i(34),me=i.n(ge);function be(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ve(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function we(e,t,i){return t&&ve(e.prototype,t),i&&ve(e,i),e}var ye=new Image;ye.src=s.a;var Se=new Image;Se.src=a.a;var ke=new Image;ke.src=c.a;var _e=new Image;_e.src=l.a;var Ce=new Image;Ce.src=f.a;var je=new Image;je.src=u.a;var Le=new Image;Le.src=m.a;var Ie=new Image;Ie.src=v.a;var xe=new Image;xe.src=y.a;var Oe=new Image;Oe.src=k.a;var Ye=new Image;Ye.src=C.a;var Ae=new Image;Ae.src=L.a;var Xe=new Image;Xe.src=x.a;var Ee=new Image;Ee.src=Y.a;var Pe=new Image;Pe.src=X.a;var Ge=new Image;Ge.src=P.a;var ze=new Image;ze.src=z.a;var Re=new Image;Re.src=T.a;var Te=new Image;Te.src=B.a;var Fe=new Image;Fe.src=M.a;var Be=new Image;Be.src=D.a;var He=new Image;He.src=q.a;var Me=new Image;Me.src=N.a;var We=new Image;We.src=U.a;var De=new Image;De.src=Q.a;var $e=new Image;$e.src=ee.a;var qe=new Image;qe.src=ie.a;var Ke=new Image;Ke.src=se.a;var Ne=new Image;Ne.src=ae.a;var Ve=new Image;Ve.src=ce.a;var Ue=new Image;Ue.src=le.a;var Je=new Image;Je.src=fe.a;var Qe=new Image;function Ze(e,t,i,n,s,o){var a={type:t,id:t+e,visible:!0,material:n,posX:s,posY:o,eventList:[],sprite:null,spriteList:[],animateSpriteCount:0,animateSpeedCount:0,animateSpeed:3,spriteWidth:0,spriteHeight:0,spriteOffsetX:0,spriteOffsetY:0};return a.die=function(){window.Game.removeObject(this)}.bind(a),a.staticAnimate=function(){this.animateSpeedCount===this.animateSpeed?(this.animateSpeedCount=0,this.animateSpriteCount===this.spriteList.length-1?this.animateSpriteCount=0:this.animateSpriteCount+=1,this.sprite=this.spriteList.getSprite(this.animateSpriteCount,this.direction)):this.animateSpeedCount+=1}.bind(a),a.moveAnimate=function(){if(!this.moves)return this.animateSpriteCount=0,this.animateSpeedCount=0,void(this.sprite=this.spriteList.getStopSprite(this.direction));this.animateSpeedCount===this.animateSpeed?(this.animateSpeedCount=0,this.animateSpriteCount===this.spriteList.length-1?this.animateSpriteCount=0:this.animateSpriteCount+=1,this.sprite=this.spriteList.getSprite(this.animateSpriteCount,this.direction)):this.animateSpeedCount+=1}.bind(a),i instanceof at?i.default?(a.spriteList=i,a.sprite=i.default[0],a.eventList.push(new ot("staticAnimate",a.staticAnimate,!1))):(a.spriteList=i,a.sprite=i.right[0],a.eventList.push(new ot("moveAnimate",a.moveAnimate,!1))):i.length?(a.spriteList=i,a.sprite=i[0]):a.sprite=i,a.addEvent=function(t,e,i,n){n&&(this.eventList=this.eventList.filter(function(e){return e.id!=="event"+t})),this.eventList.push(new ot(t||this.eventList.length,e,i))}.bind(a),a.addEventToStart=function(t,e,i,n){n&&(this.eventList=this.eventList.filter(function(e){return e.id!=="event"+t})),this.eventList.unshift(new ot(t||this.eventList.length,e,i))}.bind(a),a.startEvents=function(){var t=[];0<this.eventList.length&&(this.eventList.forEach(function(e){e.func(),e.removable||t.push(e)}),this.eventList=t)}.bind(a),a.checkClash=function(e,t){if(e.id!==this.id){var i,n,s=t/2,o=this.posX-s,a=this.posX+s,r=this.posY-s,c=this.posY+s,p=e.posX-s,l=e.posX+s,h=e.posY-s,f=e.posY+s;if(h<c&&r<f&&o<l&&p<a)if(this.clash(e),e.clash(this),"stone"===this.type)switch(i=this.posX<e.posX?"right":this.posX>e.posX?"left":"one level",n=this.posY<e.posY?"bottom":this.posY>e.posY?"top":"one level",Math.abs(this.posX-e.posX)>Math.abs(this.posY-e.posY)?i:n){case"right":"left"===e.direction&&(e.addEventToStart("stop",e.stopMove,!0),e.posX+=e.speed);break;case"left":"right"===e.direction&&(e.addEventToStart("stop",e.stopMove,!0),e.posX-=e.speed);break;case"bottom":"top"===e.direction&&(e.addEventToStart("stop",e.stopMove,!0),e.posY+=e.speed);break;case"top":"bottom"===e.direction&&(e.addEventToStart("stop",e.stopMove,!0),e.posY-=e.speed)}}}.bind(a),a.clash=function(e){}.bind(a),a}function et(e,t,i,n,s,o,a){var r=new Ze(e,t,i,!0,n,s);return r.hp=o||100,r.direction="top",r.moves=!1,r.speed=a||1,r.changeDirection=function(t){("left"!==this.direction&&"right"!==this.direction||"left"!==t&&"right"!==t)&&("top"!==this.direction&&"bottom"!==this.direction||"top"!==t&&"bottom"!==t)?this.addEventToStart("tryChangeDirection",function(){var e=window.Game.findCell({object:{posX:r.posX,posY:r.posY},direction:t});r.posX/20%2==1&&r.posY/20%2==1&&e&&0<e.objects.length&&"stone"!==e.objects[0].type&&(r.direction=t,this.removable=!0)},!1,!0):this.direction=t}.bind(r),r.startMove=function(){this.moves=!0}.bind(r),r.stopMove=function(){this.moves=!1}.bind(r),r.move=function(){if(this.moves)switch(this.direction){case"left":this.posX-=this.speed;break;case"right":this.posX+=this.speed;break;case"top":this.posY-=this.speed;break;case"bottom":this.posY+=this.speed}}.bind(r),r}function tt(e,t,i,n,s){var o=new et(e,"player",new at({left:[Fe,Be,He,Me,We,De],right:[Ee,Pe,Ge,ze,Re,Te],stop:{left:$e,right:qe}}),t,i,100,2);return o.nickName=n||"Unamed",o.score=s||0,o.eventList.push(new ot("move",o.move,!1)),o.spriteWidth=49,o.spriteHeight=53,o.spriteOffsetX=0,o.spriteOffsetY=-6,o.upScore=function(e){this.score+=e}.bind(o),o.clash=function(e){"coin"===e.type&&this.upScore(1)}.bind(o),o.control=function(e){switch(e){case"up":this.changeDirection("top"),this.startMove();break;case"right":this.changeDirection("right"),this.startMove();break;case"down":this.changeDirection("bottom"),this.startMove();break;case"left":this.changeDirection("left"),this.startMove();break;case"stop":this.stopMove()}}.bind(o),o}function it(e,t,i){var n=new Ze(e,"stone",ye,!0,t,i);return n.spriteWidth=40,n.spriteHeight=52,n.spriteOffsetY=-6,n.stoneSprites={isolated:ye,connectedLeft:Se,connectedRight:ke,connectedTop:_e,connectedBottom:Ce,betweenHorizontal:je,betweenVertical:Le,connectedBottomAndRight:Ie,connectedBottomAndLeft:xe,connectedTopAndLeft:Oe,connectedTopAndRight:Ye,connectedAll:Ae},n.setSprite=function(e){this.stoneSprites[e]&&(this.sprite=this.stoneSprites[e])}.bind(n),n}function nt(e,t,i){var n=new Ze(e,"coin",new at([Ke,Ne,Ve,Ue,Je,Qe]),!0,t,i);return n.spriteWidth=30,n.spriteHeight=30,n.spriteOffsetY=-15,n.clash=function(e){if("player"===e.type){var t=new Audio;t.src=me.a,t.volume=.005,t.play(),this.die()}}.bind(n),n}Qe.src=ue.a;var st=function(){function o(e,t,i,n,s){be(this,o),this.id="cell"+e,this.posX=t,this.posY=i,this.objects=[],this.sprite=Xe,this.fieldPosRow=n,this.fieldPosColumn=s}return we(o,[{key:"set",value:function(e){this.objects.push(e),e.posX=this.posX,e.posY=this.posY}},{key:"clear",value:function(e){e&&this.objects.forEach(function(e){e.die()}),this.objects=[]}}]),o}(),ot=function e(t,i,n){be(this,e),this.id="event"+t,this.func=i,this.removable=void 0===n||n},at=function(){function t(e){be(this,t),e.length?(this.default=e,this.length=e.length):(this.right=e.right,this.left=e.left,e.stop&&(this.stop={right:e.stop.right,left:e.stop.left}),this.length=e.left.length),this.lastDirection="right"}return we(t,[{key:"getStopSprite",value:function(e){return"right"===e?(this.lastDirection=e,this.stop.right):"left"===e?(this.lastDirection=e,this.stop.left):this.getStopSprite(this.lastDirection)}},{key:"getSprite",value:function(e,t){return t?"right"===t?(this.lastDirection=t,this.right[e]):"left"===t?(this.lastDirection=t,this.left[e]):this.getSprite(e,this.lastDirection):this.default[e]}}]),t}(),rt=[new function e(t,i,n,s,o){be(this,e),this.stoneList=t,this.traps=i,this.playersFieldCoords=n,this.mobSpawnPoints=s,this.holesInBaseStones=o}([[1,5],[1,8],[1,9],[1,11],[1,13],[1,14],[1,17],[2,2],[2,3],[2,5],[2,7],[2,8],[2,11],[2,14],[2,15],[2,17],[2,19],[2,20],[3,2],[3,7],[3,8],[3,10],[3,11],[3,12],[3,14],[3,15],[3,20],[4,4],[4,5],[4,17],[4,18],[5,1],[5,7],[5,8],[5,9],[5,11],[5,13],[5,14],[5,15],[5,21],[6,3],[6,5],[6,9],[6,11],[6,13],[6,17],[6,19],[7,1],[7,2],[7,3],[7,5],[7,6],[7,11],[7,16],[7,17],[7,19],[7,20],[7,21],[8,8],[8,9],[8,10],[8,11],[8,12],[8,13],[8,14],[9,1],[9,2],[9,3],[9,5],[9,6],[9,16],[9,17],[9,19],[9,20],[9,21],[10,3],[10,5],[10,8],[10,10],[10,12],[10,14],[10,17],[10,19],[11,7],[11,8],[11,10],[11,12],[11,14],[11,15],[12,2],[12,4],[12,5],[12,17],[12,18],[12,20],[13,2],[13,4],[13,5],[13,7],[13,8],[13,10],[13,11],[13,12],[13,14],[13,15],[13,17],[13,18],[13,20],[14,2],[14,4],[14,5],[14,7],[14,10],[14,11],[14,12],[14,15],[14,17],[14,18],[14,20],[15,7],[15,9],[15,10],[15,11],[15,12],[15,13],[15,15]],[],[[1,1],[1,21]],[],[[8,0],[8,22]])],ct=i(0);function pt(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function lt(e){return function(e){if(Array.isArray(e)){for(var t=0,i=new Array(e.length);t<e.length;t++)i[t]=e[t];return i}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function ht(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ft(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function dt(e,t,i){return t&&ft(e.prototype,t),i&&ft(e,i),e}var ut=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$gameWindow=document.querySelector(".canvasWrapper"),this.$interface=document.querySelector(".interface"),this.$playerInfoBlocks=[]}return function(e,t,i){t&&pt(e.prototype,t),i&&pt(e,i)}(e,[{key:"gamePause",value:function(){this.$gameWindow.classList.toggle("pause")}},{key:"setControls",value:function(t){document.addEventListener("keydown",function(e){return t(e)})}},{key:"createInterface",value:function(e){var o=this;e.players.forEach(function(e,t){var i=document.createElement("div"),n=document.createElement("span"),s=new Image;i.className="player_info player_info--".concat(e.id),n.className="player_info__score",n.innerHTML="Score: <span class='score_value'>".concat(e.score,"</span>"),s.src=e.sprite.src,i.append(s),i.append(n),o.$interface.append(i),o.$playerInfoBlocks.push(i)})}},{key:"interfaceReload",value:function(e){var i=this;e.players.forEach(function(t){i.$playerInfoBlocks.find(function(e){return e.classList.contains("player_info--".concat(t.id))}).querySelector(".score_value").textContent=t.score})}}]),e}()),gt=function(){function e(){ht(this,e),this.canvas=document.querySelector("#canvas"),this.ctx=this.canvas.getContext("2d"),this.windowWidth=this.canvas.clientWidth,this.windowHeight=this.canvas.clientHeight,this.cellSize=40,this.drawBackground()}return dt(e,[{key:"drawObject",value:function(e){var t=e.spriteWidth,i=e.spriteHeight,n=e.posX-this.cellSize/2,s=e.posY-this.cellSize/2;t&&i&&(n=e.posX-t/2,s=e.posY-i/2),e.spriteOffsetX&&(n+=e.spriteOffsetX),e.spriteOffsetY&&(s+=e.spriteOffsetY);try{this.ctx.drawImage(e.sprite,n,s,t||this.cellSize,i||this.cellSize)}catch(e){}}},{key:"drawCell",value:function(e){e.object&&e.object.visible&&this.drawObject(e.object)}},{key:"drawBackground",value:function(){this.ctx.fillStyle="black",this.ctx.fillRect(0,0,this.windowWidth,this.windowHeight)}}]),e}();(new(function(){function t(e){ht(this,t),(window.Game=this).eventList=[],this.Graphic=new gt,this.gameInterval=null,this.gameField=[],this.gameSpeed=60,this.paused=!1,this.stones=[],this.players=[],this.mobs=[],this.loot=[],this.mapList=rt,this.allObjects=[].concat(lt(this.stones),lt(this.players),lt(this.mobs)),this.mapCreate(this.mapList[0]),this.setControls(),ut.createInterface({players:this.players})}return dt(t,[{key:"addObject",value:function(e,t){switch(t){case"stone":this.stones.push(e);break;case"player":this.players.push(e);break;case"mobs":this.mobs.push(e);break;case"loot":this.loot.push(e)}this.allObjects.push(e)}},{key:"removeObject",value:function(t){switch(this.allObjects=this.allObjects.filter(function(e){return e.id!==t.id}),t.type){case"stone":this.stones=this.stones.filter(function(e){return e.id!==t.id}),this.stonePositionAnalyse();break;case"player":this.players=this.players.filter(function(e){return e.id!==t.id});break;case"mob":this.mobs=this.mobs.filter(function(e){return e.id!==t.id});break;default:this.loot=this.loot.filter(function(e){return e.id!==t.id})}}},{key:"setControls",value:function(){var s=this;ut.setControls(function(e){var t=ct.player1,i=ct.player2,n=ct.global;if(!s.paused)switch(e.code){case t.up:s.players[0].control("up");break;case t.right:s.players[0].control("right");break;case t.down:s.players[0].control("down");break;case t.left:s.players[0].control("left");break;case t.stop:s.players[0].control("stop");break;case i.up:s.players[1].control("up");break;case i.right:s.players[1].control("right");break;case i.down:s.players[1].control("down");break;case i.left:s.players[1].control("left");break;case i.stop:s.players[1].control("stop")}e.code===n.pause&&(s.paused?(s.start(),s.paused=!1):(s.pause(),s.paused=!0),ut.gamePause())})}},{key:"findCell",value:function(t){var i,n,e,s=[];this.gameField.forEach(function(e){e.forEach(function(e){return s.push(e)})});var o=this.Graphic.cellSize/2;if(t.fieldPosRow&&t.fieldPosColumn)e=s.find(function(e){return e.fieldPosRow===t.fieldPosRow&&e.fieldPosColumn===t.fieldPosColumn});else if(t.posX&&t.posY)i=t.posX,n=t.posY,e=s.find(function(e){return e.posX-o<=i&&e.posX+o>=i&&e.posY-o<=n&&e.posY+o>=n});else if(t.object&&t.direction){i=t.object.posX,n=t.object.posY;var a=s.find(function(e){return e.posX-o<=i&&e.posX+o>=i&&e.posY-o<=n&&e.posY+o>=n});if(!a)return null;switch(t.direction){case"top":e=this.findCell({fieldPosRow:a.fieldPosRow-1,fieldPosColumn:a.fieldPosColumn});break;case"right":e=this.findCell({fieldPosRow:a.fieldPosRow,fieldPosColumn:a.fieldPosColumn+1});break;case"bottom":e=this.findCell({fieldPosRow:a.fieldPosRow+1,fieldPosColumn:a.fieldPosColumn});break;case"left":e=this.findCell({fieldPosRow:a.fieldPosRow,fieldPosColumn:a.fieldPosColumn-1})}}return e}},{key:"stonePositionAnalyse",value:function(){var s=this,o=function(e,t){return 0<this.gameField[e][t].objects.length&&"stone"===this.gameField[e][t].objects[0].type}.bind(this);this.gameField.forEach(function(e,n){e.forEach(function(e,t){if(0<e.objects.length&&"stone"===e.objects[0].type){var i=e.objects[0];0<n&&0<t&&n<s.gameField.length-1&&t<s.gameField[0].length-1&&(o(n-1,t)&&o(n+1,t)&&o(n,t-1)&&o(n,t+1)?i.setSprite("connectedAll"):o(n+1,t)&&o(n,t+1)?i.setSprite("connectedBottomAndRight"):o(n+1,t)&&o(n,t-1)?i.setSprite("connectedBottomAndLeft"):o(n-1,t)&&o(n,t+1)?i.setSprite("connectedTopAndRight"):o(n-1,t)&&o(n,t-1)?i.setSprite("connectedTopAndLeft"):o(n,t+1)&&o(n,t-1)?i.setSprite("betweenHorizontal"):o(n+1,t)&&o(n-1,t)?i.setSprite("betweenVertical"):o(n-1,t)?i.setSprite("connectedTop"):o(n,t-1)?i.setSprite("connectedLeft"):o(n+1,t)?i.setSprite("connectedBottom"):o(n,t+1)&&i.setSprite("connectedRight"))}})})}},{key:"addStone",value:function(e,t,i){var n;n=i||new it("".concat(e,"_").concat(t)),this.addObject(n,"stone"),this.gameField[e][t].set(n)}},{key:"addStones",value:function(e){var s=this;e.forEach(function(e){var t=e[0],i=e[1],n=new it("".concat(t,"_").concat(i));s.addObject(n,"stone"),s.gameField[t][i].set(n)})}},{key:"mapCreate",value:function(e){for(var s=this,t=0;t<this.Graphic.windowHeight/this.Graphic.cellSize;t++){this.gameField[t]=[];for(var i=0;i<this.Graphic.windowWidth/this.Graphic.cellSize;i++)if(this.gameField[t][i]=new st("".concat(t,"_").concat(i),i*this.Graphic.cellSize+this.Graphic.cellSize/2,t*this.Graphic.cellSize+this.Graphic.cellSize/2,t,i),0===t||t===this.Graphic.windowHeight/this.Graphic.cellSize-1||0===i||i===this.Graphic.windowWidth/this.Graphic.cellSize-1){var n=new it("".concat(t,"_").concat(i));0===t||t===this.Graphic.windowHeight/this.Graphic.cellSize-1?0<i&&i<this.Graphic.windowWidth/this.Graphic.cellSize-1?n.setSprite("betweenHorizontal"):0===i?0===t?n.setSprite("connectedBottomAndRight"):n.setSprite("connectedTopAndRight"):0===t?n.setSprite("connectedBottomAndLeft"):n.setSprite("connectedTopAndLeft"):n.setSprite("betweenVertical"),this.addObject(n,"stone"),this.gameField[t][i].set(n)}}this.addStones(e.stoneList),e.holesInBaseStones.forEach(function(e){s.gameField[e[0]][e[1]].clear(!0)}),e.playersFieldCoords.forEach(function(e,t){s.players[t]||(s.addObject(new tt(t),"player"),s.gameField[e[0]][e[1]].set(s.players[t]))}),this.stonePositionAnalyse(),this.gameField.forEach(function(e,n){e.forEach(function(e,t){if(0===e.objects.length){var i=new nt("".concat(n,"_").concat(t),e.posX,e.posY);s.addObject(i,"loot"),e.set(i)}})})}},{key:"drawFrame",value:function(){var t=this;this.gameField.forEach(function(e){return e.forEach(function(e){t.Graphic.drawObject(e)})}),this.allObjects=this.allObjects.sort(function(e,t){return e.posY-t.posY}),this.allObjects.forEach(function(e){return t.Graphic.drawObject(e)})}},{key:"checkOverflow",value:function(){var t=this;[].concat(lt(this.mobs),lt(this.players)).forEach(function(e){e.posX>t.Graphic.windowWidth+t.Graphic.cellSize?e.posX=0-t.Graphic.cellSize:e.posX<0-t.Graphic.cellSize?e.posX=t.Graphic.windowWidth+t.Graphic.cellSize:e.posY>t.Graphic.windowHeight+t.Graphic.cellSize?e.posY=0-t.Graphic.cellSize:e.posY<0-t.Graphic.cellSize&&(e.posY=t.Graphic.windowHeight+t.Graphic.cellSize)})}},{key:"checkClash",value:function(){var i=this,e=[].concat(lt(this.mobs),lt(this.players));this.allObjects.forEach(function(t){e.forEach(function(e){t.material&&e.material&&t.checkClash(e,i.Graphic.cellSize)})})}},{key:"gameLoop",value:function(){}},{key:"start",value:function(){var e=this;this.gameInterval=setInterval(function(){e.checkClash(),e.eventList.forEach(function(e){return e()}),e.eventList=[],e.allObjects.forEach(function(e){e.eventList&&0<e.eventList.length&&e.startEvents()}),e.checkOverflow(),e.drawFrame(),ut.interfaceReload({players:e.players})},1/this.gameSpeed*1e3)}},{key:"pause",value:function(){clearInterval(this.gameInterval)}}]),t}())).start()}]);